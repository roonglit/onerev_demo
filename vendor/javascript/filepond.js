// filepond@4.32.9 downloaded from https://ga.jspm.io/npm:filepond@4.32.9/dist/filepond.js

var e=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var r={};(function(e,t){t(r)})(0,(function(r){var t=function(e){return e instanceof HTMLElement};var n=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];var n=Object.assign({},e);var i=[];var a=[];var o=function(){return Object.assign({},n)};var u=function(){var e=[].concat(i);i.length=0;return e};var s=function(){var e=[].concat(a);a.length=0;e.forEach((function(e){var r=e.type,t=e.data;l(r,t)}))};var l=function(e,r,t){if(!t||document.hidden){d[e]&&d[e](r);i.push({type:e,data:r})}else a.push({type:e,data:r})};var c=function(e){var r;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return v[e]?(r=v)[e].apply(r,n):null};var f={getState:o,processActionQueue:u,processDispatchQueue:s,dispatch:l,query:c};var v={};r.forEach((function(e){v=Object.assign({},e(n),{},v)}));var d={};t.forEach((function(e){d=Object.assign({},e(l,c,n),{},d)}));return f};var i=function(e,r,t){typeof t!=="function"?Object.defineProperty(e,r,Object.assign({},t)):e[r]=t};var a=function(e,r){for(var t in e)e.hasOwnProperty(t)&&r(t,e[t])};var o=function(e){var r={};a(e,(function(t){i(r,t,e[t])}));return r};var u=function(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(t===null)return e.getAttribute(r)||e.hasAttribute(r);e.setAttribute(r,t)};var s="http://www.w3.org/2000/svg";var l=["svg","path"];var c=function(e){return l.includes(e)};var f=function(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof r==="object"){t=r;r=null}var n=c(e)?document.createElementNS(s,e):document.createElement(e);r&&(c(e)?u(n,"class",r):n.className=r);a(t,(function(e,r){u(n,e,r)}));return n};var v=function(e){return function(r,t){typeof t!=="undefined"&&e.children[t]?e.insertBefore(r,e.children[t]):e.appendChild(r)}};var d=function(e,r){return function(e,t){typeof t!=="undefined"?r.splice(t,0,e):r.push(e);return e}};var p=function(e,r){return function(t){r.splice(r.indexOf(t),1);t.element.parentNode&&e.removeChild(t.element);return t}};var E=function(){return typeof window!=="undefined"&&typeof window.document!=="undefined"}();var _=function(){return E};var T=_()?f("svg"):{};var I="children"in T?function(e){return e.children.length}:function(e){return e.childNodes.length};var m=function(e,r,t,n){var i=t[0]||e.left;var a=t[1]||e.top;var o=i+e.width;var u=a+e.height*(n[1]||1);var s={element:Object.assign({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:i,top:a,right:o,bottom:u}};r.filter((function(e){return!e.isRectIgnored()})).map((function(e){return e.rect})).forEach((function(e){h(s.inner,Object.assign({},e.inner));h(s.outer,Object.assign({},e.outer))}));g(s.inner);s.outer.bottom+=s.element.marginBottom;s.outer.right+=s.element.marginRight;g(s.outer);return s};var h=function(e,r){r.top+=e.top;r.right+=e.left;r.bottom+=e.top;r.left+=e.left;r.bottom>e.bottom&&(e.bottom=r.bottom);r.right>e.right&&(e.right=r.right)};var g=function(e){e.width=e.right-e.left;e.height=e.bottom-e.top};var R=function(e){return typeof e==="number"};
/**
   * Determines if position is at destination
   * @param position
   * @param destination
   * @param velocity
   * @param errorMargin
   * @returns {boolean}
   */var O=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.001;return Math.abs(e-r)<n&&Math.abs(t)<n};var y=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiffness,t=r===void 0?.5:r,n=e.damping,i=n===void 0?.75:n,a=e.mass,u=a===void 0?10:a;var s=null;var l=null;var c=0;var f=false;var v=function(e,r){if(!f)if(R(s)&&R(l)){var n=-(l-s)*t;c+=n/u;l+=c;c*=i;if(O(l,s,c)||r){l=s;c=0;f=true;p.onupdate(l);p.oncomplete(l)}else p.onupdate(l)}else{f=true;c=0}};
/**
     * Set new target value
     * @param value
     */var d=function(e){R(e)&&!R(l)&&(l=e);if(s===null){s=e;l=e}s=e;if(l!==s&&typeof s!=="undefined")f=false;else{f=true;c=0;p.onupdate(l);p.oncomplete(l)}};var p=o({interpolate:v,target:{set:d,get:function(){return s}},resting:{get:function(){return f}},onupdate:function(e){},oncomplete:function(e){}});return p};var D=function(e){return e<.5?2*e*e:(4-2*e)*e-1};var S=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.duration,t=r===void 0?500:r,n=e.easing,i=n===void 0?D:n,a=e.delay,u=a===void 0?0:a;var s=null;var l;var c;var f=true;var v=false;var d=null;var p=function(e,r){if(!f&&d!==null){s===null&&(s=e);if(!(e-s<u)){l=e-s-u;if(l>=t||r){l=1;c=v?0:1;E.onupdate(c*d);E.oncomplete(c*d);f=true}else{c=l/t;E.onupdate((l>=0?i(v?1-c:c):0)*d)}}}};var E=o({interpolate:p,target:{get:function(){return v?0:d},set:function(e){if(d!==null){if(e<d){d=1;v=true}else{v=false;d=e}f=false;s=null}else{d=e;E.onupdate(e);E.oncomplete(e)}}},resting:{get:function(){return f}},onupdate:function(e){},oncomplete:function(e){}});return E};var A={spring:y,tween:S};var L=function(e,r,t){var n=e[r]&&typeof e[r][t]==="object"?e[r][t]:e[r]||e;var i=typeof n==="string"?n:n.type;var a=typeof n==="object"?Object.assign({},n):{};return A[i]?A[i](a):null};var b=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];r=Array.isArray(r)?r:[r];r.forEach((function(r){e.forEach((function(e){var i=e;var a=function(){return t[e]};var o=function(r){return t[e]=r};if(typeof e==="object"){i=e.key;a=e.getter||a;o=e.setter||o}r[i]&&!n||(r[i]={get:a,set:o})}))}))};var P=function(e){var r=e.mixinConfig,t=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI;var o=Object.assign({},t);var u=[];a(r,(function(e,r){var a=L(r);if(a){a.onupdate=function(r){t[e]=r};a.target=o[e];var s={key:e,setter:function(e){a.target!==e&&(a.target=e)},getter:function(){return t[e]}};b([s],[n,i],t,true);u.push(a)}}));return{write:function(e){var r=document.hidden;var t=true;u.forEach((function(n){n.resting||(t=false);n.interpolate(e,r)}));return t},destroy:function(){}}};var M=function(e){return function(r,t){e.addEventListener(r,t)}};var C=function(e){return function(r,t){e.removeEventListener(r,t)}};var N=function(e){e.mixinConfig,e.viewProps,e.viewInternalAPI;var r=e.viewExternalAPI,t=(e.viewState,e.view);var n=[];var i=M(t.element);var a=C(t.element);r.on=function(e,r){n.push({type:e,fn:r});i(e,r)};r.off=function(e,r){n.splice(n.findIndex((function(t){return t.type===e&&t.fn===r})),1);a(e,r)};return{write:function(){return true},destroy:function(){n.forEach((function(e){a(e.type,e.fn)}))}}};var w=function(e){var r=e.mixinConfig,t=e.viewProps,n=e.viewExternalAPI;b(r,n,t)};var G=function(e){return e!=null};var U={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0};var B=function(e){var r=e.mixinConfig,t=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI,a=e.view;var o=Object.assign({},t);var u={};b(r,[n,i],t);var s=function(){return[t.translateX||0,t.translateY||0]};var l=function(){return[t.scaleX||0,t.scaleY||0]};var c=function(){return a.rect?m(a.rect,a.childViews,s(),l()):null};n.rect={get:c};i.rect={get:c};r.forEach((function(e){t[e]=typeof o[e]==="undefined"?U[e]:o[e]}));return{write:function(){if(F(u,t)){q(a.element,t);Object.assign(u,Object.assign({},t));return true}},destroy:function(){}}};var F=function(e,r){if(Object.keys(e).length!==Object.keys(r).length)return true;for(var t in r)if(r[t]!==e[t])return true;return false};var q=function(e,r){var t=r.opacity,n=r.perspective,i=r.translateX,a=r.translateY,o=r.scaleX,u=r.scaleY,s=r.rotateX,l=r.rotateY,c=r.rotateZ,f=r.originX,v=r.originY,d=r.width,p=r.height;var E="";var _="";(G(f)||G(v))&&(_+="transform-origin: "+(f||0)+"px "+(v||0)+"px;");G(n)&&(E+="perspective("+n+"px) ");(G(i)||G(a))&&(E+="translate3d("+(i||0)+"px, "+(a||0)+"px, 0) ");(G(o)||G(u))&&(E+="scale3d("+(G(o)?o:1)+", "+(G(u)?u:1)+", 1) ");G(c)&&(E+="rotateZ("+c+"rad) ");G(s)&&(E+="rotateX("+s+"rad) ");G(l)&&(E+="rotateY("+l+"rad) ");E.length&&(_+="transform:"+E+";");if(G(t)){_+="opacity:"+t+";";t===0&&(_+="visibility:hidden;");t<1&&(_+="pointer-events:none;")}G(p)&&(_+="height:"+p+"px;");G(d)&&(_+="width:"+d+"px;");var T=e.elementCurrentStyle||"";if(_.length!==T.length||_!==T){e.style.cssText=_;e.elementCurrentStyle=_}};var V={styles:B,listeners:N,animations:P,apis:w};var x=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!r.layoutCalculated){e.paddingTop=parseInt(t.paddingTop,10)||0;e.marginTop=parseInt(t.marginTop,10)||0;e.marginRight=parseInt(t.marginRight,10)||0;e.marginBottom=parseInt(t.marginBottom,10)||0;e.marginLeft=parseInt(t.marginLeft,10)||0;r.layoutCalculated=true}e.left=r.offsetLeft||0;e.top=r.offsetTop||0;e.width=r.offsetWidth||0;e.height=r.offsetHeight||0;e.right=e.left+e.width;e.bottom=e.top+e.height;e.scrollTop=r.scrollTop;e.hidden=r.offsetParent===null;return e};var Y=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.tag,t=r===void 0?"div":r,n=e.name,i=n===void 0?null:n,a=e.attributes,u=a===void 0?{}:a,s=e.read,l=s===void 0?function(){}:s,c=e.write,E=c===void 0?function(){}:c,_=e.create,T=_===void 0?function(){}:_,h=e.destroy,g=h===void 0?function(){}:h,R=e.filterFrameActionsForChild,O=R===void 0?function(e,r){return r}:R,y=e.didCreateView,D=y===void 0?function(){}:y,S=e.didWriteView,A=S===void 0?function(){}:S,L=e.ignoreRect,b=L!==void 0&&L,P=e.ignoreRectUpdate,M=P!==void 0&&P,C=e.mixins,N=C===void 0?[]:C;return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n=f(t,"filepond--"+i,u);var a=window.getComputedStyle(n,null);var s=x();var c=null;var _=false;var h=[];var R=[];var y={};var S={};var L=[E];var P=[l];var C=[g];var w=function(){return n};var G=function(){return h.concat()};var U=function(){return y};var B=function(e){return function(r,t){return r(e,t)}};var F=function(){if(c)return c;c=m(s,h,[0,0],[1,1]);return c};var q=function(){return a};var Y=function(){c=null;h.forEach((function(e){return e._read()}));var e=!(M&&s.width&&s.height);e&&x(s,n,a);var t={root:Q,props:r,rect:s};P.forEach((function(e){return e(t)}))};var k=function(e,t,n){var i=t.length===0;L.forEach((function(a){var o=a({props:r,root:Q,actions:t,timestamp:e,shouldOptimize:n});o===false&&(i=false)}));R.forEach((function(r){var t=r.write(e);t===false&&(i=false)}));h.filter((function(e){return!!e.element.parentNode})).forEach((function(r){var a=r._write(e,O(r,t),n);a||(i=false)}));h.forEach((function(r,a){if(!r.element.parentNode){Q.appendChild(r.element,a);r._read();r._write(e,O(r,t),n);i=false}}));_=i;A({props:r,root:Q,actions:t,timestamp:e});return i};var j=function(){R.forEach((function(e){return e.destroy()}));C.forEach((function(e){e({root:Q,props:r})}));h.forEach((function(e){return e._destroy()}))};var H={element:{get:w},style:{get:q},childViews:{get:G}};var W=Object.assign({},H,{rect:{get:F},ref:{get:U},is:function(e){return i===e},appendChild:v(n),createChildView:B(e),linkView:function(e){h.push(e);return e},unlinkView:function(e){h.splice(h.indexOf(e),1)},appendChildView:d(n,h),removeChildView:p(n,h),registerWriter:function(e){return L.push(e)},registerReader:function(e){return P.push(e)},registerDestroyer:function(e){return C.push(e)},invalidateLayout:function(){return n.layoutCalculated=false},dispatch:e.dispatch,query:e.query});var X={element:{get:w},childViews:{get:G},rect:{get:F},resting:{get:function(){return _}},isRectIgnored:function(){return b},_read:Y,_write:k,_destroy:j};var z=Object.assign({},H,{rect:{get:function(){return s}}});Object.keys(N).sort((function(e,r){return e==="styles"?1:r==="styles"?-1:0})).forEach((function(e){var t=V[e]({mixinConfig:N[e],viewProps:r,viewState:S,viewInternalAPI:W,viewExternalAPI:X,view:o(z)});t&&R.push(t)}));var Q=o(W);T({root:Q,props:r});var Z=I(n);h.forEach((function(e,r){Q.appendChild(e.element,Z+r)}));D(Q);return o(X)}};var k=function(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:60;var n="__framePainter";if(!window[n]){window[n]={readers:[e],writers:[r]};var i=window[n];var a=1e3/t;var o=null;var u=null;var s=null;var l=null;var c=function(){if(document.hidden){s=function(){return window.setTimeout((function(){return f(performance.now())}),a)};l=function(){return window.clearTimeout(u)}}else{s=function(){return window.requestAnimationFrame(f)};l=function(){return window.cancelAnimationFrame(u)}}};document.addEventListener("visibilitychange",(function(){l&&l();c();f(performance.now())}));var f=function e(r){u=s(e);o||(o=r);var t=r-o;if(!(t<=a)){o=r-t%a;i.readers.forEach((function(e){return e()}));i.writers.forEach((function(e){return e(r)}))}};c();f(performance.now());return{pause:function(){l(u)}}}window[n].readers.push(e);window[n].writers.push(r)};var j=function(e,r){return function(t){var n=t.root,i=t.props,a=t.actions,o=a===void 0?[]:a,u=t.timestamp,s=t.shouldOptimize;o.filter((function(r){return e[r.type]})).forEach((function(r){return e[r.type]({root:n,props:i,action:r.data,timestamp:u,shouldOptimize:s})}));r&&r({root:n,props:i,actions:o,timestamp:u,shouldOptimize:s})}};var H=function(e,r){return r.parentNode.insertBefore(e,r)};var W=function(e,r){return r.parentNode.insertBefore(e,r.nextSibling)};var X=function(e){return Array.isArray(e)};var z=function(e){return e==null};var Q=function(e){return e.trim()};var Z=function(e){return""+e};var K=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return z(e)?[]:X(e)?e:Z(e).split(r).map(Q).filter((function(e){return e.length}))};var $=function(e){return typeof e==="boolean"};var J=function(e){return $(e)?e:e==="true"};var ee=function(e){return typeof e==="string"};var re=function(e){return R(e)?e:ee(e)?Z(e).replace(/[a-z]+/gi,""):0};var te=function(e){return parseInt(re(e),10)};var ne=function(e){return parseFloat(re(e))};var ie=function(e){return R(e)&&isFinite(e)&&Math.floor(e)===e};var ae=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(ie(e))return e;var t=Z(e).trim();if(/MB$/i.test(t)){t=t.replace(/MB$i/,"").trim();return te(t)*r*r}if(/KB/i.test(t)){t=t.replace(/KB$i/,"").trim();return te(t)*r}return te(t)};var oe=function(e){return typeof e==="function"};var ue=function(e){var r=self;var t=e.split(".");var n=null;while(n=t.shift()){r=r[n];if(!r)return null}return r};var se={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"};var le=function(e){var r={};r.url=ee(e)?e:e.url||"";r.timeout=e.timeout?parseInt(e.timeout,10):0;r.headers=e.headers?e.headers:{};a(se,(function(t){r[t]=ce(t,e[t],se[t],r.timeout,r.headers)}));r.process=e.process||ee(e)||e.url?r.process:null;r.remove=e.remove||null;delete r.headers;return r};var ce=function(e,r,t,n,i){if(r===null)return null;if(typeof r==="function")return r;var a={url:t==="GET"||t==="PATCH"?"?"+e+"=":"",method:t,headers:i,withCredentials:false,timeout:n,onload:null,ondata:null,onerror:null};if(ee(r)){a.url=r;return a}Object.assign(a,r);if(ee(a.headers)){var o=a.headers.split(/:(.+)/);a.headers={header:o[0],value:o[1]}}a.withCredentials=J(a.withCredentials);return a};var fe=function(e){return le(e)};var ve=function(e){return e===null};var de=function(e){return typeof e==="object"&&e!==null};var pe=function(e){return de(e)&&ee(e.url)&&de(e.process)&&de(e.revert)&&de(e.restore)&&de(e.fetch)};var Ee=function(e){return X(e)?"array":ve(e)?"null":ie(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":pe(e)?"api":typeof e};var _e=function(e){return e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",')};var Te={array:K,boolean:J,int:function(e){return Ee(e)==="bytes"?ae(e):te(e)},number:ne,float:ne,bytes:ae,string:function(e){return oe(e)?e:Z(e)},function:function(e){return ue(e)},serverapi:fe,object:function(e){try{return JSON.parse(_e(e))}catch(e){return null}}};var Ie=function(e,r){return Te[r](e)};var me=function(e,r,t){if(e===r)return e;var n=Ee(e);if(n!==t){var i=Ie(e,t);n=Ee(i);if(i===null)throw'Trying to assign value with incorrect type to "'+option+'", allowed type: "'+t+'"';e=i}return e};var he=function(e,r){var t=e;return{enumerable:true,get:function(){return t},set:function(n){t=me(n,e,r)}}};var ge=function(e){var r={};a(e,(function(t){var n=e[t];r[t]=he(n[0],n[1])}));return o(r)};var Re=function(e){return{items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:ge(e)}};var Oe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"-";return e.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join(r)};var ye=function(e,r){var t={};a(r,(function(r){t[r]={get:function(){return e.getState().options[r]},set:function(t){e.dispatch("SET_"+Oe(r,"_").toUpperCase(),{value:t})}}}));return t};var De=function(e){return function(r,t,n){var i={};a(e,(function(e){var t=Oe(e,"_").toUpperCase();i["SET_"+t]=function(i){try{n.options[e]=i.value}catch(e){}r("DID_SET_"+t,{value:n.options[e]})}}));return i}};var Se=function(e){return function(r){var t={};a(e,(function(e){t["GET_"+Oe(e,"_").toUpperCase()]=function(t){return r.options[e]}}));return t}};var Ae={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5};var Le=function(){return Math.random().toString(36).substring(2,11)};function be(r){(this||e).wrapped=r}function Pe(r){var t,n;function i(e,r){return new Promise((function(i,o){var u={key:e,arg:r,resolve:i,reject:o,next:null};if(n)n=n.next=u;else{t=n=u;a(e,r)}}))}function a(e,t){try{var n=r[e](t);var i=n.value;var u=i instanceof be;Promise.resolve(u?i.wrapped:i).then((function(e){u?a("next",e):o(n.done?"return":"normal",e)}),(function(e){a("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:true});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:false});break}t=t.next;t?a(t.key,t.arg):n=null}(this||e)._invoke=i;typeof r.return!=="function"&&((this||e).return=void 0)}typeof Symbol==="function"&&Symbol.asyncIterator&&(Pe.prototype[Symbol.asyncIterator]=function(){return this||e});Pe.prototype.next=function(e){return this._invoke("next",e)};Pe.prototype.throw=function(e){return this._invoke("throw",e)};Pe.prototype.return=function(e){return this._invoke("return",e)};function Me(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var i,a;for(a=0;a<n.length;a++){i=n[a];r.indexOf(i)>=0||(t[i]=e[i])}return t}function Ce(e,r){if(e==null)return{};var t=Me(e,r);var n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++){n=a[i];r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}}return t}function Ne(e){return we(e)||Ge(e)||Ue()}function we(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function Ge(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function Ue(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var Be=function(e,r){return e.splice(r,1)};var Fe=function(e,r){r?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)};var qe=function(){var e=[];var r=function(r,t){Be(e,e.findIndex((function(e){return e.event===r&&(e.cb===t||!t)})))};var t=function(r,t,n){e.filter((function(e){return e.event===r})).map((function(e){return e.cb})).forEach((function(e){return Fe((function(){return e.apply(void 0,Ne(t))}),n)}))};return{fireSync:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t(e,n,true)},fire:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t(e,n,false)},on:function(r,t){e.push({event:r,cb:t})},onOnce:function(t,n){e.push({event:t,cb:function(){r(t,n);n.apply(void 0,arguments)}})},off:r}};var Ve=function(e,r,t){Object.getOwnPropertyNames(e).filter((function(e){return!t.includes(e)})).forEach((function(t){return Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))};var xe=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"];var Ye=function(e){var r={};Ve(e,r,xe);return r};var ke=function(e){e.forEach((function(r,t){r.released&&Be(e,t)}))};var je={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8};var He={INPUT:1,LIMBO:2,LOCAL:3};var We=function(e){return/[^0-9]+/.exec(e)};var Xe=function(){return We(1.1.toLocaleString())[0]};var ze=function(){var e=Xe();var r=1e3.toLocaleString();var t=1e3.toString();return r!==t?We(r)[0]:e==="."?",":"."};var Qe={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"};var Ze=[];var Ke=function(e,r,t){return new Promise((function(n,i){var a=Ze.filter((function(r){return r.key===e})).map((function(e){return e.cb}));if(a.length!==0){var o=a.shift();a.reduce((function(e,r){return e.then((function(e){return r(e,t)}))}),o(r,t)).then((function(e){return n(e)})).catch((function(e){return i(e)}))}else n(r)}))};var $e=function(e,r,t){return Ze.filter((function(r){return r.key===e})).map((function(e){return e.cb(r,t)}))};var Je=function(e,r){return Ze.push({key:e,cb:r})};var er=function(e){return Object.assign(nr,e)};var rr=function(){return Object.assign({},nr)};var tr=function(e){a(e,(function(e,r){nr[e]&&(nr[e][0]=me(r,nr[e][0],nr[e][1]))}))};var nr={id:[null,Qe.STRING],name:["filepond",Qe.STRING],disabled:[false,Qe.BOOLEAN],className:[null,Qe.STRING],required:[false,Qe.BOOLEAN],captureMethod:[null,Qe.STRING],allowSyncAcceptAttribute:[true,Qe.BOOLEAN],allowDrop:[true,Qe.BOOLEAN],allowBrowse:[true,Qe.BOOLEAN],allowPaste:[true,Qe.BOOLEAN],allowMultiple:[false,Qe.BOOLEAN],allowReplace:[true,Qe.BOOLEAN],allowRevert:[true,Qe.BOOLEAN],allowRemove:[true,Qe.BOOLEAN],allowProcess:[true,Qe.BOOLEAN],allowReorder:[false,Qe.BOOLEAN],allowDirectoriesOnly:[false,Qe.BOOLEAN],storeAsFile:[false,Qe.BOOLEAN],forceRevert:[false,Qe.BOOLEAN],maxFiles:[null,Qe.INT],checkValidity:[false,Qe.BOOLEAN],itemInsertLocationFreedom:[true,Qe.BOOLEAN],itemInsertLocation:["before",Qe.STRING],itemInsertInterval:[75,Qe.INT],dropOnPage:[false,Qe.BOOLEAN],dropOnElement:[true,Qe.BOOLEAN],dropValidation:[false,Qe.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],Qe.ARRAY],instantUpload:[true,Qe.BOOLEAN],maxParallelUploads:[2,Qe.INT],allowMinimumUploadDuration:[true,Qe.BOOLEAN],chunkUploads:[false,Qe.BOOLEAN],chunkForce:[false,Qe.BOOLEAN],chunkSize:[5e6,Qe.INT],chunkRetryDelays:[[500,1e3,3e3],Qe.ARRAY],server:[null,Qe.SERVER_API],fileSizeBase:[1e3,Qe.INT],labelFileSizeBytes:["bytes",Qe.STRING],labelFileSizeKilobytes:["KB",Qe.STRING],labelFileSizeMegabytes:["MB",Qe.STRING],labelFileSizeGigabytes:["GB",Qe.STRING],labelDecimalSeparator:[Xe(),Qe.STRING],labelThousandsSeparator:[ze(),Qe.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',Qe.STRING],labelInvalidField:["Field contains invalid files",Qe.STRING],labelFileWaitingForSize:["Waiting for size",Qe.STRING],labelFileSizeNotAvailable:["Size not available",Qe.STRING],labelFileCountSingular:["file in list",Qe.STRING],labelFileCountPlural:["files in list",Qe.STRING],labelFileLoading:["Loading",Qe.STRING],labelFileAdded:["Added",Qe.STRING],labelFileLoadError:["Error during load",Qe.STRING],labelFileRemoved:["Removed",Qe.STRING],labelFileRemoveError:["Error during remove",Qe.STRING],labelFileProcessing:["Uploading",Qe.STRING],labelFileProcessingComplete:["Upload complete",Qe.STRING],labelFileProcessingAborted:["Upload cancelled",Qe.STRING],labelFileProcessingError:["Error during upload",Qe.STRING],labelFileProcessingRevertError:["Error during revert",Qe.STRING],labelTapToCancel:["tap to cancel",Qe.STRING],labelTapToRetry:["tap to retry",Qe.STRING],labelTapToUndo:["tap to undo",Qe.STRING],labelButtonRemoveItem:["Remove",Qe.STRING],labelButtonAbortItemLoad:["Abort",Qe.STRING],labelButtonRetryItemLoad:["Retry",Qe.STRING],labelButtonAbortItemProcessing:["Cancel",Qe.STRING],labelButtonUndoItemProcessing:["Undo",Qe.STRING],labelButtonRetryItemProcessing:["Retry",Qe.STRING],labelButtonProcessItem:["Upload",Qe.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',Qe.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',Qe.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',Qe.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',Qe.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',Qe.STRING],oninit:[null,Qe.FUNCTION],onwarning:[null,Qe.FUNCTION],onerror:[null,Qe.FUNCTION],onactivatefile:[null,Qe.FUNCTION],oninitfile:[null,Qe.FUNCTION],onaddfilestart:[null,Qe.FUNCTION],onaddfileprogress:[null,Qe.FUNCTION],onaddfile:[null,Qe.FUNCTION],onprocessfilestart:[null,Qe.FUNCTION],onprocessfileprogress:[null,Qe.FUNCTION],onprocessfileabort:[null,Qe.FUNCTION],onprocessfilerevert:[null,Qe.FUNCTION],onprocessfile:[null,Qe.FUNCTION],onprocessfiles:[null,Qe.FUNCTION],onremovefile:[null,Qe.FUNCTION],onpreparefile:[null,Qe.FUNCTION],onupdatefiles:[null,Qe.FUNCTION],onreorderfiles:[null,Qe.FUNCTION],beforeDropFile:[null,Qe.FUNCTION],beforeAddFile:[null,Qe.FUNCTION],beforeRemoveFile:[null,Qe.FUNCTION],beforePrepareFile:[null,Qe.FUNCTION],stylePanelLayout:[null,Qe.STRING],stylePanelAspectRatio:[null,Qe.STRING],styleItemPanelAspectRatio:[null,Qe.STRING],styleButtonRemoveItemPosition:["left",Qe.STRING],styleButtonProcessItemPosition:["right",Qe.STRING],styleLoadIndicatorPosition:["right",Qe.STRING],styleProgressIndicatorPosition:["right",Qe.STRING],styleButtonRemoveItemAlign:[false,Qe.BOOLEAN],files:[[],Qe.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],Qe.ARRAY]};var ir=function(e,r){if(z(r))return e[0]||null;if(ie(r))return e[r]||null;typeof r==="object"&&(r=r.id);return e.find((function(e){return e.id===r}))||null};var ar=function(e){if(z(e))return e;if(/:/.test(e)){var r=e.split(":");return r[1]/r[0]}return parseFloat(e)};var or=function(e){return e.filter((function(e){return!e.archived}))};var ur={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};var sr=null;var lr=function(){if(sr===null)try{var e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));var r=document.createElement("input");r.setAttribute("type","file");r.files=e.files;sr=r.files.length===1}catch(e){sr=false}return sr};var cr=[je.LOAD_ERROR,je.PROCESSING_ERROR,je.PROCESSING_REVERT_ERROR];var fr=[je.LOADING,je.PROCESSING,je.PROCESSING_QUEUED,je.INIT];var vr=[je.PROCESSING_COMPLETE];var dr=function(e){return cr.includes(e.status)};var pr=function(e){return fr.includes(e.status)};var Er=function(e){return vr.includes(e.status)};var _r=function(e){return de(e.options.server)&&(de(e.options.server.process)||oe(e.options.server.process))};var Tr=function(e){return{GET_STATUS:function(){var r=or(e.items);var t=ur.EMPTY,n=ur.ERROR,i=ur.BUSY,a=ur.IDLE,o=ur.READY;return r.length===0?t:r.some(dr)?n:r.some(pr)?i:r.some(Er)?o:a},GET_ITEM:function(r){return ir(e.items,r)},GET_ACTIVE_ITEM:function(r){return ir(or(e.items),r)},GET_ACTIVE_ITEMS:function(){return or(e.items)},GET_ITEMS:function(){return e.items},GET_ITEM_NAME:function(r){var t=ir(e.items,r);return t?t.filename:null},GET_ITEM_SIZE:function(r){var t=ir(e.items,r);return t?t.fileSize:null},GET_STYLES:function(){return Object.keys(e.options).filter((function(e){return/^style/.test(e)})).map((function(r){return{name:r,value:e.options[r]}}))},GET_PANEL_ASPECT_RATIO:function(){var r=/circle/.test(e.options.stylePanelLayout);var t=r?1:ar(e.options.stylePanelAspectRatio);return t},GET_ITEM_PANEL_ASPECT_RATIO:function(){return e.options.styleItemPanelAspectRatio},GET_ITEMS_BY_STATUS:function(r){return or(e.items).filter((function(e){return e.status===r}))},GET_TOTAL_ITEMS:function(){return or(e.items).length},SHOULD_UPDATE_FILE_INPUT:function(){return e.options.storeAsFile&&lr()&&!_r(e)},IS_ASYNC:function(){return _r(e)},GET_FILE_SIZE_LABELS:function(e){return{labelBytes:e("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:e("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:e("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:e("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0}}}};var Ir=function(e){var r=or(e.items).length;if(!e.options.allowMultiple)return r===0;var t=e.options.maxFiles;return t===null||r<t};var mr=function(e,r,t){return Math.max(Math.min(t,e),r)};var hr=function(e,r,t){return e.splice(r,0,t)};var gr=function(e,r,t){if(z(r))return null;if(typeof t==="undefined"){e.push(r);return r}t=mr(t,0,e.length);hr(e,t,r);return r};var Rr=function(e){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e)};var Or=function(e){return(""+e).split("/").pop().split("?").shift()};var yr=function(e){return e.split(".").pop()};var Dr=function(e){if(typeof e!=="string")return"";var r=e.split("/").pop();return/svg/.test(r)?"svg":/zip|compressed/.test(r)?"zip":/plain/.test(r)?"txt":/msword/.test(r)?"doc":/[a-z]+/.test(r)?r==="jpeg"?"jpg":r:""};var Sr=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(r+e).slice(-r.length)};var Ar=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return e.getFullYear()+"-"+Sr(e.getMonth()+1,"00")+"-"+Sr(e.getDate(),"00")+"_"+Sr(e.getHours(),"00")+"-"+Sr(e.getMinutes(),"00")+"-"+Sr(e.getSeconds(),"00")};var Lr=function(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;var i=typeof t==="string"?e.slice(0,e.size,t):e.slice(0,e.size,e.type);i.lastModifiedDate=new Date;e._relativePath&&(i._relativePath=e._relativePath);ee(r)||(r=Ar());if(r&&n===null&&yr(r))i.name=r;else{n=n||Dr(i.type);i.name=r+(n?"."+n:"")}return i};var br=function(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder};var Pr=function(e,r){var t=br();if(t){var n=new t;n.append(e);return n.getBlob(r)}return new Blob([e],{type:r})};var Mr=function(e,r){var t=new ArrayBuffer(e.length);var n=new Uint8Array(t);for(var i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return Pr(t,r)};var Cr=function(e){return(/^data:(.+);/.exec(e)||[])[1]||null};var Nr=function(e){var r=e.split(",")[1];return r.replace(/\s/g,"")};var wr=function(e){return atob(Nr(e))};var Gr=function(e){var r=Cr(e);var t=wr(e);return Mr(t,r)};var Ur=function(e,r,t){return Lr(Gr(e),r,null,t)};var Br=function(e){if(!/^content-disposition:/i.test(e))return null;var r=e.split(/filename=|filename\*=.+''/).splice(1).map((function(e){return e.trim().replace(/^["']|[;"']{0,2}$/g,"")})).filter((function(e){return e.length}));return r.length?decodeURI(r[r.length-1]):null};var Fr=function(e){if(/content-length:/i.test(e)){var r=e.match(/[0-9]+/)[0];return r?parseInt(r,10):null}return null};var qr=function(e){if(/x-content-transfer-id:/i.test(e)){var r=(e.split(":")[1]||"").trim();return r||null}return null};var Vr=function(e){var r={source:null,name:null,size:null};var t=e.split("\n");var n=true;var i=false;var a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=true){var s=o.value;var l=Br(s);if(l)r.name=l;else{var c=Fr(s);if(c)r.size=c;else{var f=qr(s);f&&(r.source=f)}}}}catch(e){i=true;a=e}finally{try{n||u.return==null||u.return()}finally{if(i)throw a}}return r};var xr=function(e){var r={source:null,complete:false,progress:0,size:null,timestamp:null,duration:0,request:null};var t=function(){return r.progress};var n=function(){r.request&&r.request.abort&&r.request.abort()};var i=function(){var e=r.source;o.fire("init",e);e instanceof File?o.fire("load",e):e instanceof Blob?o.fire("load",Lr(e,e.name)):Rr(e)?o.fire("load",Ur(e)):a(e)};var a=function(t){if(e){r.timestamp=Date.now();r.request=e(t,(function(e){r.duration=Date.now()-r.timestamp;r.complete=true;e instanceof Blob&&(e=Lr(e,e.name||Or(t)));o.fire("load",e instanceof Blob?e:e?e.body:null)}),(function(e){o.fire("error",typeof e==="string"?{type:"error",code:0,body:e}:e)}),(function(e,t,n){n&&(r.size=n);r.duration=Date.now()-r.timestamp;if(e){r.progress=t/n;o.fire("progress",r.progress)}else r.progress=null}),(function(){o.fire("abort")}),(function(e){var t=Vr(typeof e==="string"?e:e.headers);o.fire("meta",{size:r.size||t.size,filename:t.name,source:t.source})}))}else o.fire("error",{type:"error",body:"Can't load URL",code:400})};var o=Object.assign({},qe(),{setSource:function(e){return r.source=e},getProgress:t,abort:n,load:i});return o};var Yr=function(e){return/GET|HEAD/.test(e)};var kr=function(e,r,t){var n={onheaders:function(){},onprogress:function(){},onload:function(){},ontimeout:function(){},onerror:function(){},onabort:function(){},abort:function(){i=true;o.abort()}};var i=false;var a=false;t=Object.assign({method:"POST",headers:{},withCredentials:false},t);r=encodeURI(r);Yr(t.method)&&e&&(r=""+r+encodeURIComponent(typeof e==="string"?e:JSON.stringify(e)));var o=new XMLHttpRequest;var u=Yr(t.method)?o:o.upload;u.onprogress=function(e){i||n.onprogress(e.lengthComputable,e.loaded,e.total)};o.onreadystatechange=function(){if(!(o.readyState<2)&&(o.readyState!==4||o.status!==0)&&!a){a=true;n.onheaders(o)}};o.onload=function(){o.status>=200&&o.status<300?n.onload(o):n.onerror(o)};o.onerror=function(){return n.onerror(o)};o.onabort=function(){i=true;n.onabort()};o.ontimeout=function(){return n.ontimeout(o)};o.open(t.method,r,true);ie(t.timeout)&&(o.timeout=t.timeout);Object.keys(t.headers).forEach((function(e){var r=unescape(encodeURIComponent(t.headers[e]));o.setRequestHeader(e,r)}));t.responseType&&(o.responseType=t.responseType);t.withCredentials&&(o.withCredentials=true);o.send(e);return n};var jr=function(e,r,t,n){return{type:e,code:r,body:t,headers:n}};var Hr=function(e){return function(r){e(jr("error",0,"Timeout",r.getAllResponseHeaders()))}};var Wr=function(e){return/\?/.test(e)};var Xr=function(){var e="";for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];t.forEach((function(r){e+=Wr(e)&&Wr(r)?r.replace(/\?/,"&"):r}));return e};var zr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";var r=arguments.length>1?arguments[1]:void 0;if(typeof r==="function")return r;if(!r||!ee(r.url))return null;var t=r.onload||function(e){return e};var n=r.onerror||function(e){return null};return function(i,a,o,u,s,l){var c=kr(i,Xr(e,r.url),Object.assign({},r,{responseType:"blob"}));c.onload=function(e){var n=e.getAllResponseHeaders();var o=Vr(n).name||Or(i);a(jr("load",e.status,r.method==="HEAD"?null:Lr(t(e.response),o),n))};c.onerror=function(e){o(jr("error",e.status,n(e.response)||e.statusText,e.getAllResponseHeaders()))};c.onheaders=function(e){l(jr("headers",e.status,null,e.getAllResponseHeaders()))};c.ontimeout=Hr(o);c.onprogress=u;c.onabort=s;return c}};var Qr={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4};var Zr=function(e,r,t,n,i,a,o,u,s,l,c){var f=[];var v=c.chunkTransferId,d=c.chunkServer,p=c.chunkSize,E=c.chunkRetryDelays;var _={serverId:v,aborted:false};var T=r.ondata||function(e){return e};var I=r.onload||function(e,r){return r==="HEAD"?e.getResponseHeader("Upload-Offset"):e.response};var m=r.onerror||function(e){return null};var h=function(a){var u=new FormData;de(i)&&u.append(t,JSON.stringify(i));var s=typeof r.headers==="function"?r.headers(n,i):Object.assign({},r.headers,{"Upload-Length":n.size});var l=Object.assign({},r,{headers:s});var c=kr(T(u),Xr(e,r.url),l);c.onload=function(e){return a(I(e,l.method))};c.onerror=function(e){return o(jr("error",e.status,m(e.response)||e.statusText,e.getAllResponseHeaders()))};c.ontimeout=Hr(o)};var g=function(t){var n=Xr(e,d.url,_.serverId);var i=typeof r.headers==="function"?r.headers(_.serverId):Object.assign({},r.headers);var a={headers:i,method:"HEAD"};var u=kr(null,n,a);u.onload=function(e){return t(I(e,a.method))};u.onerror=function(e){return o(jr("error",e.status,m(e.response)||e.statusText,e.getAllResponseHeaders()))};u.ontimeout=Hr(o)};var R=Math.floor(n.size/p);for(var O=0;O<=R;O++){var y=O*p;var D=n.slice(y,y+p,"application/offset+octet-stream");f[O]={index:O,size:D.size,offset:y,data:D,file:n,progress:0,retries:Ne(E),status:Qr.QUEUED,error:null,request:null,timeout:null}}var S=function(){return a(_.serverId)};var A=function(e){return e.status===Qr.QUEUED||e.status===Qr.ERROR};var L=function(r){if(!_.aborted){r=r||f.find(A);if(r){r.status=Qr.PROCESSING;r.progress=null;var t=d.ondata||function(e){return e};var i=d.onerror||function(e){return null};var a=d.onload||function(){};var u=Xr(e,d.url,_.serverId);var l=typeof d.headers==="function"?d.headers(r):Object.assign({},d.headers,{"Content-Type":"application/offset+octet-stream","Upload-Offset":r.offset,"Upload-Length":n.size,"Upload-Name":n.name});var c=r.request=kr(t(r.data),u,Object.assign({},d,{headers:l}));c.onload=function(e){a(e,r.index,f.length);r.status=Qr.COMPLETE;r.request=null;M()};c.onprogress=function(e,t,n){r.progress=e?t:null;P()};c.onerror=function(e){r.status=Qr.ERROR;r.request=null;r.error=i(e.response)||e.statusText;b(r)||o(jr("error",e.status,i(e.response)||e.statusText,e.getAllResponseHeaders()))};c.ontimeout=function(e){r.status=Qr.ERROR;r.request=null;b(r)||Hr(o)(e)};c.onabort=function(){r.status=Qr.QUEUED;r.request=null;s()}}else f.every((function(e){return e.status===Qr.COMPLETE}))&&S()}};var b=function(e){if(e.retries.length===0)return false;e.status=Qr.WAITING;clearTimeout(e.timeout);e.timeout=setTimeout((function(){L(e)}),e.retries.shift());return true};var P=function(){var e=f.reduce((function(e,r){return e===null||r.progress===null?null:e+r.progress}),0);if(e===null)return u(false,0,0);var r=f.reduce((function(e,r){return e+r.size}),0);u(true,e,r)};var M=function(){var e=f.filter((function(e){return e.status===Qr.PROCESSING})).length;e>=1||L()};var C=function(){f.forEach((function(e){clearTimeout(e.timeout);e.request&&e.request.abort()}))};_.serverId?g((function(e){if(!_.aborted){f.filter((function(r){return r.offset<e})).forEach((function(e){e.status=Qr.COMPLETE;e.progress=e.size}));M()}})):h((function(e){if(!_.aborted){l(e);_.serverId=e;M()}}));return{abort:function(){_.aborted=true;C()}}};var Kr=function(e,r,t,n){return function(i,a,o,u,s,l,c){if(i){var f=n.chunkUploads;var v=f&&i.size>n.chunkSize;var d=f&&(v||n.chunkForce);if(i instanceof Blob&&d)return Zr(e,r,t,i,a,o,u,s,l,c,n);var p=r.ondata||function(e){return e};var E=r.onload||function(e){return e};var _=r.onerror||function(e){return null};var T=typeof r.headers==="function"?r.headers(i,a)||{}:Object.assign({},r.headers);var I=Object.assign({},r,{headers:T});var m=new FormData;de(a)&&m.append(t,JSON.stringify(a));(i instanceof Blob?[{name:null,file:i}]:i).forEach((function(e){m.append(t,e.file,e.name===null?e.file.name:""+e.name+e.file.name)}));var h=kr(p(m),Xr(e,r.url),I);h.onload=function(e){o(jr("load",e.status,E(e.response),e.getAllResponseHeaders()))};h.onerror=function(e){u(jr("error",e.status,_(e.response)||e.statusText,e.getAllResponseHeaders()))};h.ontimeout=Hr(u);h.onprogress=s;h.onabort=l;return h}}};var $r=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";var r=arguments.length>1?arguments[1]:void 0;var t=arguments.length>2?arguments[2]:void 0;var n=arguments.length>3?arguments[3]:void 0;return typeof r==="function"?function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return r.apply(void 0,[t].concat(i,[n]))}:r&&ee(r.url)?Kr(e,r,t,n):null};var Jr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";var r=arguments.length>1?arguments[1]:void 0;if(typeof r==="function")return r;if(!r||!ee(r.url))return function(e,r){return r()};var t=r.onload||function(e){return e};var n=r.onerror||function(e){return null};return function(i,a,o){var u=kr(i,e+r.url,r);u.onload=function(e){a(jr("load",e.status,t(e.response),e.getAllResponseHeaders()))};u.onerror=function(e){o(jr("error",e.status,n(e.response)||e.statusText,e.getAllResponseHeaders()))};u.ontimeout=Hr(o);return u}};var et=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return e+Math.random()*(r-e)};var rt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;arguments.length>2&&arguments[2]!==void 0&&arguments[2];var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:25;var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:250;var i=null;var a=Date.now();var o=function o(){var u=Date.now()-a;var s=et(t,n);u+s>r&&(s=u+s-r);var l=u/r;if(l>=1||document.hidden)e(1);else{e(l);i=setTimeout(o,s)}};r>0&&o();return{clear:function(){clearTimeout(i)}}};var tt=function(e,r){var t={complete:false,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null};var n=r.allowMinimumUploadDuration;var i=function(r,i){var a=function(){t.duration!==0&&t.progress!==null&&l.fire("progress",l.getProgress())};var o=function(){t.complete=true;l.fire("load-perceived",t.response.body)};l.fire("start");t.timestamp=Date.now();t.perceivedPerformanceUpdater=rt((function(e){t.perceivedProgress=e;t.perceivedDuration=Date.now()-t.timestamp;a();t.response&&t.perceivedProgress===1&&!t.complete&&o()}),n?et(750,1500):0);t.request=e(r,i,(function(e){t.response=de(e)?e:{type:"load",code:200,body:""+e,headers:{}};t.duration=Date.now()-t.timestamp;t.progress=1;l.fire("load",t.response.body);(!n||n&&t.perceivedProgress===1)&&o()}),(function(e){t.perceivedPerformanceUpdater.clear();l.fire("error",de(e)?e:{type:"error",code:0,body:""+e})}),(function(e,r,n){t.duration=Date.now()-t.timestamp;t.progress=e?r/n:null;a()}),(function(){t.perceivedPerformanceUpdater.clear();l.fire("abort",t.response?t.response.body:null)}),(function(e){l.fire("transfer",e)}))};var a=function(){if(t.request){t.perceivedPerformanceUpdater.clear();t.request.abort&&t.request.abort();t.complete=true}};var o=function(){a();t.complete=false;t.perceivedProgress=0;t.progress=0;t.timestamp=null;t.perceivedDuration=0;t.duration=0;t.request=null;t.response=null};var u=n?function(){return t.progress?Math.min(t.progress,t.perceivedProgress):null}:function(){return t.progress||null};var s=n?function(){return Math.min(t.duration,t.perceivedDuration)}:function(){return t.duration};var l=Object.assign({},qe(),{process:i,abort:a,getProgress:u,getDuration:s,reset:o});return l};var nt=function(e){return e.substring(0,e.lastIndexOf("."))||e};var it=function(e){var r=[e.name,e.size,e.type];if(e instanceof Blob||Rr(e))r[0]=e.name||Ar();else if(Rr(e)){r[1]=e.length;r[2]=Cr(e)}else if(ee(e)){r[0]=Or(e);r[1]=0;r[2]="application/octet-stream"}return{name:r[0],size:r[1],type:r[2]}};var at=function(e){return!!(e instanceof File||e instanceof Blob&&e.name)};var ot=function e(r){if(!de(r))return r;var t=X(r)?[]:{};for(var n in r)if(r.hasOwnProperty(n)){var i=r[n];t[n]=i&&de(i)?e(i):i}return t};var ut=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;var n=Le();var i={archived:false,frozen:false,released:false,source:null,file:t,serverFileReference:r,transferId:null,processingAborted:false,status:r?je.PROCESSING_COMPLETE:je.INIT,activeLoader:null,activeProcessor:null};var a=null;var u={};var s=function(e){return i.status=e};var l=function(e){if(!i.released&&!i.frozen){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];O.fire.apply(O,[e].concat(t))}};var c=function(){return yr(i.file.name)};var f=function(){return i.file.type};var v=function(){return i.file.size};var d=function(){return i.file};var p=function(r,t,n){i.source=r;O.fireSync("init");if(i.file)O.fireSync("load-skip");else{i.file=it(r);t.on("init",(function(){l("load-init")}));t.on("meta",(function(r){i.file.size=r.size;i.file.filename=r.filename;if(r.source){e=He.LIMBO;i.serverFileReference=r.source;i.status=je.PROCESSING_COMPLETE}l("load-meta")}));t.on("progress",(function(e){s(je.LOADING);l("load-progress",e)}));t.on("error",(function(e){s(je.LOAD_ERROR);l("load-request-error",e)}));t.on("abort",(function(){s(je.INIT);l("load-abort")}));t.on("load",(function(r){i.activeLoader=null;var t=function(r){i.file=at(r)?r:i.file;e===He.LIMBO&&i.serverFileReference?s(je.PROCESSING_COMPLETE):s(je.IDLE);l("load")};var a=function(e){i.file=r;l("load-meta");s(je.LOAD_ERROR);l("load-file-error",e)};i.serverFileReference?t(r):n(r,t,a)}));t.setSource(r);i.activeLoader=t;t.load()}};var E=function(){i.activeLoader&&i.activeLoader.load()};var _=function(){if(i.activeLoader)i.activeLoader.abort();else{s(je.INIT);l("load-abort")}};var T=function e(r,t){if(i.processingAborted)i.processingAborted=false;else{s(je.PROCESSING);a=null;if(i.file instanceof Blob){r.on("load",(function(e){i.transferId=null;i.serverFileReference=e}));r.on("transfer",(function(e){i.transferId=e}));r.on("load-perceived",(function(e){i.activeProcessor=null;i.transferId=null;i.serverFileReference=e;s(je.PROCESSING_COMPLETE);l("process-complete",e)}));r.on("start",(function(){l("process-start")}));r.on("error",(function(e){i.activeProcessor=null;s(je.PROCESSING_ERROR);l("process-error",e)}));r.on("abort",(function(e){i.activeProcessor=null;i.serverFileReference=e;s(je.IDLE);l("process-abort");a&&a()}));r.on("progress",(function(e){l("process-progress",e)}));var n=function(e){i.archived||r.process(e,Object.assign({},u))};var o=console.error;t(i.file,n,o);i.activeProcessor=r}else O.on("load",(function(){e(r,t)}))}};var I=function(){i.processingAborted=false;s(je.PROCESSING_QUEUED)};var m=function(){return new Promise((function(e){if(i.activeProcessor){a=function(){e()};i.activeProcessor.abort()}else{i.processingAborted=true;s(je.IDLE);l("process-abort");e()}}))};var h=function(e,r){return new Promise((function(t,n){var a=i.serverFileReference!==null?i.serverFileReference:i.transferId;if(a!==null){e(a,(function(){i.serverFileReference=null;i.transferId=null;t()}),(function(e){if(r){s(je.PROCESSING_REVERT_ERROR);l("process-revert-error");n(e)}else t()}));s(je.IDLE);l("process-revert")}else t()}))};var g=function(e,r,t){var n=e.split(".");var i=n[0];var a=n.pop();var o=u;n.forEach((function(e){return o=o[e]}));if(JSON.stringify(o[a])!==JSON.stringify(r)){o[a]=r;l("metadata-update",{key:i,value:u[i],silent:t})}};var R=function(e){return ot(e?u[e]:u)};var O=Object.assign({id:{get:function(){return n}},origin:{get:function(){return e},set:function(r){return e=r}},serverId:{get:function(){return i.serverFileReference}},transferId:{get:function(){return i.transferId}},status:{get:function(){return i.status}},filename:{get:function(){return i.file.name}},filenameWithoutExtension:{get:function(){return nt(i.file.name)}},fileExtension:{get:c},fileType:{get:f},fileSize:{get:v},file:{get:d},relativePath:{get:function(){return i.file._relativePath}},source:{get:function(){return i.source}},getMetadata:R,setMetadata:function(e,r,t){if(de(e)){var n=e;Object.keys(n).forEach((function(e){g(e,n[e],r)}));return e}g(e,r,t);return r},extend:function(e,r){return y[e]=r},abortLoad:_,retryLoad:E,requestProcessing:I,abortProcessing:m,load:p,process:T,revert:h},qe(),{freeze:function(){return i.frozen=true},release:function(){return i.released=true},released:{get:function(){return i.released}},archive:function(){return i.archived=true},archived:{get:function(){return i.archived}},setFile:function(e){return i.file=e}});var y=o(O);return y};var st=function(e,r){return z(r)?0:ee(r)?e.findIndex((function(e){return e.id===r})):-1};var lt=function(e,r){var t=st(e,r);if(!(t<0))return e[t]||null};var ct=function(e,r,t,n,i,a){var o=kr(null,e,{method:"GET",responseType:"blob"});o.onload=function(t){var n=t.getAllResponseHeaders();var i=Vr(n).name||Or(e);r(jr("load",t.status,Lr(t.response,i),n))};o.onerror=function(e){t(jr("error",e.status,e.statusText,e.getAllResponseHeaders()))};o.onheaders=function(e){a(jr("headers",e.status,null,e.getAllResponseHeaders()))};o.ontimeout=Hr(t);o.onprogress=n;o.onabort=i;return o};var ft=function(e){e.indexOf("//")===0&&(e=location.protocol+e);return e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]};var vt=function(e){return(e.indexOf(":")>-1||e.indexOf("//")>-1)&&ft(location.href)!==ft(e)};var dt=function(e){return function(){return oe(e)?e.apply(void 0,arguments):e}};var pt=function(e){return!at(e.file)};var Et=function(e,r){clearTimeout(r.listUpdateTimeout);r.listUpdateTimeout=setTimeout((function(){e("DID_UPDATE_ITEMS",{items:or(r.items)})}),0)};var _t=function(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return new Promise((function(r){if(!e)return r(true);var n=e.apply(void 0,t);if(n==null)return r(true);if(typeof n==="boolean")return r(n);typeof n.then==="function"&&n.then(r)}))};var Tt=function(e,r){e.items.sort((function(e,t){return r(Ye(e),Ye(t))}))};var It=function(e,r){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var n=t.query,i=t.success,a=i===void 0?function(){}:i,o=t.failure,u=o===void 0?function(){}:o,s=Ce(t,["query","success","failure"]);var l=ir(e.items,n);l?r(l,a,u,s||{}):u({error:jr("error",0,"Item not found"),file:null})}};var mt=function(e,r,t){return{ABORT_ALL:function(){or(t.items).forEach((function(e){e.freeze();e.abortLoad();e.abortProcessing()}))},DID_SET_FILES:function(r){var n=r.value,i=n===void 0?[]:n;var a=i.map((function(e){return{source:e.source?e.source:e,options:e.options}}));var o=or(t.items);o.forEach((function(r){a.find((function(e){return e.source===r.source||e.source===r.file}))||e("REMOVE_ITEM",{query:r,remove:false})}));o=or(t.items);a.forEach((function(r,t){o.find((function(e){return e.source===r.source||e.file===r.source}))||e("ADD_ITEM",Object.assign({},r,{interactionMethod:Ae.NONE,index:t}))}))},DID_UPDATE_ITEM_METADATA:function(n){var i=n.id,a=n.action,o=n.change;if(!o.silent){clearTimeout(t.itemUpdateTimeout);t.itemUpdateTimeout=setTimeout((function(){var n=lt(t.items,i);if(r("IS_ASYNC")){n.origin===He.LOCAL&&e("DID_LOAD_ITEM",{id:n.id,error:null,serverFileReference:n.source});var u=function(){setTimeout((function(){e("REQUEST_ITEM_PROCESSING",{query:i})}),32)};var s=function(e){n.revert(Jr(t.options.server.url,t.options.server.revert),r("GET_FORCE_REVERT")).then(e?u:function(){}).catch((function(){}))};var l=function(e){n.abortProcessing().then(e?u:function(){})};if(n.status===je.PROCESSING_COMPLETE)return s(t.options.instantUpload);if(n.status===je.PROCESSING)return l(t.options.instantUpload);t.options.instantUpload&&u()}else Ke("SHOULD_PREPARE_OUTPUT",false,{item:n,query:r,action:a,change:o}).then((function(t){var a=r("GET_BEFORE_PREPARE_FILE");a&&(t=a(n,t));t&&e("REQUEST_PREPARE_OUTPUT",{query:i,item:n,success:function(r){e("DID_PREPARE_OUTPUT",{id:i,file:r})}},true)}))}),0)}},MOVE_ITEM:function(e){var r=e.query,n=e.index;var i=ir(t.items,r);if(i){var a=t.items.indexOf(i);n=mr(n,0,t.items.length-1);a!==n&&t.items.splice(n,0,t.items.splice(a,1)[0])}},SORT:function(n){var i=n.compare;Tt(t,i);e("DID_SORT_ITEMS",{items:r("GET_ACTIVE_ITEMS")})},ADD_ITEMS:function(t){var n=t.items,i=t.index,a=t.interactionMethod,o=t.success,u=o===void 0?function(){}:o,s=t.failure,l=s===void 0?function(){}:s;var c=i;if(i===-1||typeof i==="undefined"){var f=r("GET_ITEM_INSERT_LOCATION");var v=r("GET_TOTAL_ITEMS");c=f==="before"?0:v}var d=r("GET_IGNORED_FILES");var p=function(e){return at(e)?!d.includes(e.name.toLowerCase()):!z(e)};var E=n.filter(p);var _=E.map((function(r){return new Promise((function(t,n){e("ADD_ITEM",{interactionMethod:a,source:r.source||r,success:t,failure:n,index:c++,options:r.options||{}})}))}));Promise.all(_).then(u).catch(l)},
/**
       * @param source
       * @param index
       * @param interactionMethod
       */
ADD_ITEM:function(n){var i=n.source,a=n.index,o=a===void 0?-1:a,u=n.interactionMethod,s=n.success,l=s===void 0?function(){}:s,c=n.failure,f=c===void 0?function(){}:c,v=n.options,d=v===void 0?{}:v;if(z(i))f({error:jr("error",0,"No source"),file:null});else if(!at(i)||!t.options.ignoredFiles.includes(i.name.toLowerCase())){if(!Ir(t)){if(t.options.allowMultiple||!t.options.allowMultiple&&!t.options.allowReplace){var p=jr("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:i,error:p});f({error:p,file:null});return}var E=or(t.items)[0];if(E.status===je.PROCESSING_COMPLETE||E.status===je.PROCESSING_REVERT_ERROR){var _=r("GET_FORCE_REVERT");E.revert(Jr(t.options.server.url,t.options.server.revert),_).then((function(){_&&e("ADD_ITEM",{source:i,index:o,interactionMethod:u,success:l,failure:f,options:d})})).catch((function(){}));if(_)return}e("REMOVE_ITEM",{query:E.id})}var T=d.type==="local"?He.LOCAL:d.type==="limbo"?He.LIMBO:He.INPUT;var I=ut(T,T===He.INPUT?null:i,d.file);Object.keys(d.metadata||{}).forEach((function(e){I.setMetadata(e,d.metadata[e])}));$e("DID_CREATE_ITEM",I,{query:r,dispatch:e});var m=r("GET_ITEM_INSERT_LOCATION");t.options.itemInsertLocationFreedom||(o=m==="before"?-1:t.items.length);gr(t.items,I,o);oe(m)&&i&&Tt(t,m);var h=I.id;I.on("init",(function(){e("DID_INIT_ITEM",{id:h})}));I.on("load-init",(function(){e("DID_START_ITEM_LOAD",{id:h})}));I.on("load-meta",(function(){e("DID_UPDATE_ITEM_META",{id:h})}));I.on("load-progress",(function(r){e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:h,progress:r})}));I.on("load-request-error",(function(r){var n=dt(t.options.labelFileLoadError)(r);if(r.code>=400&&r.code<500){e("DID_THROW_ITEM_INVALID",{id:h,error:r,status:{main:n,sub:r.code+" ("+r.body+")"}});f({error:r,file:Ye(I)})}else e("DID_THROW_ITEM_LOAD_ERROR",{id:h,error:r,status:{main:n,sub:t.options.labelTapToRetry}})}));I.on("load-file-error",(function(r){e("DID_THROW_ITEM_INVALID",{id:h,error:r.status,status:r.status});f({error:r.status,file:Ye(I)})}));I.on("load-abort",(function(){e("REMOVE_ITEM",{query:h})}));I.on("load-skip",(function(){I.on("metadata-update",(function(r){at(I.file)&&e("DID_UPDATE_ITEM_METADATA",{id:h,change:r})}));e("COMPLETE_LOAD_ITEM",{query:h,item:I,data:{source:i,success:l}})}));I.on("load",(function(){var n=function(n){if(n){I.on("metadata-update",(function(r){e("DID_UPDATE_ITEM_METADATA",{id:h,change:r})}));Ke("SHOULD_PREPARE_OUTPUT",false,{item:I,query:r}).then((function(n){var a=r("GET_BEFORE_PREPARE_FILE");a&&(n=a(I,n));var o=function(){e("COMPLETE_LOAD_ITEM",{query:h,item:I,data:{source:i,success:l}});Et(e,t)};n?e("REQUEST_PREPARE_OUTPUT",{query:h,item:I,success:function(r){e("DID_PREPARE_OUTPUT",{id:h,file:r});o()}},true):o()}))}else e("REMOVE_ITEM",{query:h})};Ke("DID_LOAD_ITEM",I,{query:r,dispatch:e}).then((function(){_t(r("GET_BEFORE_ADD_FILE"),Ye(I)).then(n)})).catch((function(r){if(!r||!r.error||!r.status)return n(false);e("DID_THROW_ITEM_INVALID",{id:h,error:r.error,status:r.status})}))}));I.on("process-start",(function(){e("DID_START_ITEM_PROCESSING",{id:h})}));I.on("process-progress",(function(r){e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:h,progress:r})}));I.on("process-error",(function(r){e("DID_THROW_ITEM_PROCESSING_ERROR",{id:h,error:r,status:{main:dt(t.options.labelFileProcessingError)(r),sub:t.options.labelTapToRetry}})}));I.on("process-revert-error",(function(r){e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:h,error:r,status:{main:dt(t.options.labelFileProcessingRevertError)(r),sub:t.options.labelTapToRetry}})}));I.on("process-complete",(function(r){e("DID_COMPLETE_ITEM_PROCESSING",{id:h,error:null,serverFileReference:r});e("DID_DEFINE_VALUE",{id:h,value:r})}));I.on("process-abort",(function(){e("DID_ABORT_ITEM_PROCESSING",{id:h})}));I.on("process-revert",(function(){e("DID_REVERT_ITEM_PROCESSING",{id:h});e("DID_DEFINE_VALUE",{id:h,value:null})}));e("DID_ADD_ITEM",{id:h,index:o,interactionMethod:u});Et(e,t);var g=t.options.server||{},R=g.url,O=g.load,y=g.restore,D=g.fetch;I.load(i,xr(T===He.INPUT?ee(i)&&vt(i)&&D?zr(R,D):ct:T===He.LIMBO?zr(R,y):zr(R,O)),(function(e,t,n){Ke("LOAD_FILE",e,{query:r}).then(t).catch(n)}))}},REQUEST_PREPARE_OUTPUT:function(e){var t=e.item,n=e.success,i=e.failure,a=i===void 0?function(){}:i;var o={error:jr("error",0,"Item not found"),file:null};if(t.archived)return a(o);Ke("PREPARE_OUTPUT",t.file,{query:r,item:t}).then((function(e){Ke("COMPLETE_PREPARE_OUTPUT",e,{query:r,item:t}).then((function(e){if(t.archived)return a(o);n(e)}))}))},COMPLETE_LOAD_ITEM:function(n){var i=n.item,a=n.data;var o=a.success,u=a.source;var s=r("GET_ITEM_INSERT_LOCATION");oe(s)&&u&&Tt(t,s);e("DID_LOAD_ITEM",{id:i.id,error:null,serverFileReference:i.origin===He.INPUT?null:u});o(Ye(i));if(i.origin!==He.LOCAL)if(i.origin!==He.LIMBO)r("IS_ASYNC")&&t.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:i.id});else{e("DID_COMPLETE_ITEM_PROCESSING",{id:i.id,error:null,serverFileReference:u});e("DID_DEFINE_VALUE",{id:i.id,value:i.serverId||u})}else e("DID_LOAD_LOCAL_ITEM",{id:i.id})},RETRY_ITEM_LOAD:It(t,(function(e){e.retryLoad()})),REQUEST_ITEM_PREPARE:It(t,(function(r,t,n){e("REQUEST_PREPARE_OUTPUT",{query:r.id,item:r,success:function(n){e("DID_PREPARE_OUTPUT",{id:r.id,file:n});t({file:r,output:n})},failure:n},true)})),REQUEST_ITEM_PROCESSING:It(t,(function(n,i,a){var o=n.status===je.IDLE||n.status===je.PROCESSING_ERROR;if(o){if(n.status!==je.PROCESSING_QUEUED){n.requestProcessing();e("DID_REQUEST_ITEM_PROCESSING",{id:n.id});e("PROCESS_ITEM",{query:n,success:i,failure:a},true)}}else{var u=function(){return e("REQUEST_ITEM_PROCESSING",{query:n,success:i,failure:a})};var s=function(){return document.hidden?u():setTimeout(u,32)};n.status===je.PROCESSING_COMPLETE||n.status===je.PROCESSING_REVERT_ERROR?n.revert(Jr(t.options.server.url,t.options.server.revert),r("GET_FORCE_REVERT")).then(s).catch((function(){})):n.status===je.PROCESSING&&n.abortProcessing().then(s)}})),PROCESS_ITEM:It(t,(function(n,i,a){var o=r("GET_MAX_PARALLEL_UPLOADS");var u=r("GET_ITEMS_BY_STATUS",je.PROCESSING).length;if(u!==o){if(n.status!==je.PROCESSING){var s=function r(){var n=t.processingQueue.shift();if(n){var i=n.id,a=n.success,o=n.failure;var u=ir(t.items,i);u&&!u.archived?e("PROCESS_ITEM",{query:i,success:a,failure:o},true):r()}};n.onOnce("process-complete",(function(){i(Ye(n));s();var a=t.options.server;var o=t.options.instantUpload;if(o&&n.origin===He.LOCAL&&oe(a.remove)){var u=function(){};n.origin=He.LIMBO;t.options.server.remove(n.source,u,u)}var l=r("GET_ITEMS_BY_STATUS",je.PROCESSING_COMPLETE).length===t.items.length;l&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}));n.onOnce("process-error",(function(e){a({error:e,file:Ye(n)});s()}));var l=t.options;n.process(tt($r(l.server.url,l.server.process,l.name,{chunkTransferId:n.transferId,chunkServer:l.server.patch,chunkUploads:l.chunkUploads,chunkForce:l.chunkForce,chunkSize:l.chunkSize,chunkRetryDelays:l.chunkRetryDelays}),{allowMinimumUploadDuration:r("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(function(t,i,a){Ke("PREPARE_OUTPUT",t,{query:r,item:n}).then((function(r){e("DID_PREPARE_OUTPUT",{id:n.id,file:r});i(r)})).catch(a)}))}}else t.processingQueue.push({id:n.id,success:i,failure:a})})),RETRY_ITEM_PROCESSING:It(t,(function(r){e("REQUEST_ITEM_PROCESSING",{query:r})})),REQUEST_REMOVE_ITEM:It(t,(function(t){_t(r("GET_BEFORE_REMOVE_FILE"),Ye(t)).then((function(r){r&&e("REMOVE_ITEM",{query:t})}))})),RELEASE_ITEM:It(t,(function(e){e.release()})),REMOVE_ITEM:It(t,(function(n,i,a,o){var u=function(){var r=n.id;lt(t.items,r).archive();e("DID_REMOVE_ITEM",{error:null,id:r,item:n});Et(e,t);i(Ye(n))};var s=t.options.server;if(n.origin===He.LOCAL&&s&&oe(s.remove)&&o.remove!==false){e("DID_START_ITEM_REMOVE",{id:n.id});s.remove(n.source,(function(){return u()}),(function(r){e("DID_THROW_ITEM_REMOVE_ERROR",{id:n.id,error:jr("error",0,r,null),status:{main:dt(t.options.labelFileRemoveError)(r),sub:t.options.labelTapToRetry}})}))}else{(o.revert&&n.origin!==He.LOCAL&&n.serverId!==null||t.options.chunkUploads&&n.file.size>t.options.chunkSize||t.options.chunkUploads&&t.options.chunkForce)&&n.revert(Jr(t.options.server.url,t.options.server.revert),r("GET_FORCE_REVERT"));u()}})),ABORT_ITEM_LOAD:It(t,(function(e){e.abortLoad()})),ABORT_ITEM_PROCESSING:It(t,(function(r){r.serverId?e("REVERT_ITEM_PROCESSING",{id:r.id}):r.abortProcessing().then((function(){var n=t.options.instantUpload;n&&e("REMOVE_ITEM",{query:r.id})}))})),REQUEST_REVERT_ITEM_PROCESSING:It(t,(function(n){if(t.options.instantUpload){var i=function(r){r&&e("REVERT_ITEM_PROCESSING",{query:n})};var a=r("GET_BEFORE_REMOVE_FILE");if(!a)return i(true);var o=a(Ye(n));if(o==null)return i(true);if(typeof o==="boolean")return i(o);typeof o.then==="function"&&o.then(i)}else e("REVERT_ITEM_PROCESSING",{query:n})})),REVERT_ITEM_PROCESSING:It(t,(function(n){n.revert(Jr(t.options.server.url,t.options.server.revert),r("GET_FORCE_REVERT")).then((function(){var r=t.options.instantUpload||pt(n);r&&e("REMOVE_ITEM",{query:n.id})})).catch((function(){}))})),SET_OPTIONS:function(r){var t=r.options;var n=Object.keys(t);var i=ht.filter((function(e){return n.includes(e)}));var a=[].concat(Ne(i),Ne(Object.keys(t).filter((function(e){return!i.includes(e)}))));a.forEach((function(r){e("SET_"+Oe(r,"_").toUpperCase(),{value:t[r]})}))}}};var ht=["server"];var gt=function(e){return e};var Rt=function(e){return document.createElement(e)};var Ot=function(e,r){var t=e.childNodes[0];if(t)r!==t.nodeValue&&(t.nodeValue=r);else{t=document.createTextNode(r);e.appendChild(t)}};var yt=function(e,r,t,n){var i=(n%360-90)*Math.PI/180;return{x:e+t*Math.cos(i),y:r+t*Math.sin(i)}};var Dt=function(e,r,t,n,i,a){var o=yt(e,r,t,i);var u=yt(e,r,t,n);return["M",o.x,o.y,"A",t,t,0,a,0,u.x,u.y].join(" ")};var St=function(e,r,t,n,i){var a=1;i>n&&i-n<=.5&&(a=0);n>i&&n-i>=.5&&(a=0);return Dt(e,r,t,Math.min(.9999,n)*360,Math.min(.9999,i)*360,a)};var At=function(e){var r=e.root,t=e.props;t.spin=false;t.progress=0;t.opacity=0;var n=f("svg");r.ref.path=f("path",{"stroke-width":2,"stroke-linecap":"round"});n.appendChild(r.ref.path);r.ref.svg=n;r.appendChild(n)};var Lt=function(e){var r=e.root,t=e.props;if(t.opacity!==0){t.align&&(r.element.dataset.align=t.align);var n=parseInt(u(r.ref.path,"stroke-width"),10);var i=r.rect.element.width*.5;var a=0;var o=0;if(t.spin){a=0;o=.5}else{a=0;o=t.progress}var s=St(i,i,i-n,a,o);u(r.ref.path,"d",s);u(r.ref.path,"stroke-opacity",t.spin||t.progress>0?1:0)}};var bt=Y({tag:"div",name:"progress-indicator",ignoreRectUpdate:true,ignoreRect:true,create:At,write:Lt,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}});var Pt=function(e){var r=e.root,t=e.props;r.element.innerHTML=(t.icon||"")+"<span>"+t.label+"</span>";t.isDisabled=false};var Mt=function(e){var r=e.root,t=e.props;var n=t.isDisabled;var i=r.query("GET_DISABLED")||t.opacity===0;if(i&&!n){t.isDisabled=true;u(r.element,"disabled","disabled")}else if(!i&&n){t.isDisabled=false;r.element.removeAttribute("disabled")}};var Ct=Y({tag:"button",attributes:{type:"button"},ignoreRect:true,ignoreRectUpdate:true,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:true},create:Pt,write:Mt});var Nt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".";var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};var i=n.labelBytes,a=i===void 0?"bytes":i,o=n.labelKilobytes,u=o===void 0?"KB":o,s=n.labelMegabytes,l=s===void 0?"MB":s,c=n.labelGigabytes,f=c===void 0?"GB":c;e=Math.round(Math.abs(e));var v=t;var d=t*t;var p=t*t*t;return e<v?e+" "+a:e<d?Math.floor(e/v)+" "+u:e<p?wt(e/d,1,r)+" "+l:wt(e/p,2,r)+" "+f};var wt=function(e,r,t){return e.toFixed(r).split(".").filter((function(e){return e!=="0"})).join(t)};var Gt=function(e){var r=e.root,t=e.props;var n=Rt("span");n.className="filepond--file-info-main";u(n,"aria-hidden","true");r.appendChild(n);r.ref.fileName=n;var i=Rt("span");i.className="filepond--file-info-sub";r.appendChild(i);r.ref.fileSize=i;Ot(i,r.query("GET_LABEL_FILE_WAITING_FOR_SIZE"));Ot(n,gt(r.query("GET_ITEM_NAME",t.id)))};var Ut=function(e){var r=e.root,t=e.props;Ot(r.ref.fileSize,Nt(r.query("GET_ITEM_SIZE",t.id),".",r.query("GET_FILE_SIZE_BASE"),r.query("GET_FILE_SIZE_LABELS",r.query)));Ot(r.ref.fileName,gt(r.query("GET_ITEM_NAME",t.id)))};var Bt=function(e){var r=e.root,t=e.props;ie(r.query("GET_ITEM_SIZE",t.id))?Ut({root:r,props:t}):Ot(r.ref.fileSize,r.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))};var Ft=Y({name:"file-info",ignoreRect:true,ignoreRectUpdate:true,write:j({DID_LOAD_ITEM:Ut,DID_UPDATE_ITEM_META:Ut,DID_THROW_ITEM_LOAD_ERROR:Bt,DID_THROW_ITEM_INVALID:Bt}),didCreateView:function(e){$e("CREATE_VIEW",Object.assign({},e,{view:e}))},create:Gt,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}});var qt=function(e){return Math.round(e*100)};var Vt=function(e){var r=e.root;var t=Rt("span");t.className="filepond--file-status-main";r.appendChild(t);r.ref.main=t;var n=Rt("span");n.className="filepond--file-status-sub";r.appendChild(n);r.ref.sub=n;xt({root:r,action:{progress:null}})};var xt=function(e){var r=e.root,t=e.action;var n=t.progress===null?r.query("GET_LABEL_FILE_LOADING"):r.query("GET_LABEL_FILE_LOADING")+" "+qt(t.progress)+"%";Ot(r.ref.main,n);Ot(r.ref.sub,r.query("GET_LABEL_TAP_TO_CANCEL"))};var Yt=function(e){var r=e.root,t=e.action;var n=t.progress===null?r.query("GET_LABEL_FILE_PROCESSING"):r.query("GET_LABEL_FILE_PROCESSING")+" "+qt(t.progress)+"%";Ot(r.ref.main,n);Ot(r.ref.sub,r.query("GET_LABEL_TAP_TO_CANCEL"))};var kt=function(e){var r=e.root;Ot(r.ref.main,r.query("GET_LABEL_FILE_PROCESSING"));Ot(r.ref.sub,r.query("GET_LABEL_TAP_TO_CANCEL"))};var jt=function(e){var r=e.root;Ot(r.ref.main,r.query("GET_LABEL_FILE_PROCESSING_ABORTED"));Ot(r.ref.sub,r.query("GET_LABEL_TAP_TO_RETRY"))};var Ht=function(e){var r=e.root;Ot(r.ref.main,r.query("GET_LABEL_FILE_PROCESSING_COMPLETE"));Ot(r.ref.sub,r.query("GET_LABEL_TAP_TO_UNDO"))};var Wt=function(e){var r=e.root;Ot(r.ref.main,"");Ot(r.ref.sub,"")};var Xt=function(e){var r=e.root,t=e.action;Ot(r.ref.main,t.status.main);Ot(r.ref.sub,t.status.sub)};var zt=Y({name:"file-status",ignoreRect:true,ignoreRectUpdate:true,write:j({DID_LOAD_ITEM:Wt,DID_REVERT_ITEM_PROCESSING:Wt,DID_REQUEST_ITEM_PROCESSING:kt,DID_ABORT_ITEM_PROCESSING:jt,DID_COMPLETE_ITEM_PROCESSING:Ht,DID_UPDATE_ITEM_PROCESS_PROGRESS:Yt,DID_UPDATE_ITEM_LOAD_PROGRESS:xt,DID_THROW_ITEM_LOAD_ERROR:Xt,DID_THROW_ITEM_INVALID:Xt,DID_THROW_ITEM_PROCESSING_ERROR:Xt,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:Xt,DID_THROW_ITEM_REMOVE_ERROR:Xt}),didCreateView:function(e){$e("CREATE_VIEW",Object.assign({},e,{view:e}))},create:Vt,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}});var Qt={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}};var Zt=[];a(Qt,(function(e){Zt.push(e)}));var Kt=function(e){if(nn(e)==="right")return 0;var r=e.ref.buttonRemoveItem.rect.element;return r.hidden?null:r.width+r.left};var $t=function(e){var r=e.ref.buttonAbortItemLoad.rect.element;return r.width};var Jt=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.height/4)};var en=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.left/2)};var rn=function(e){return e.query("GET_STYLE_LOAD_INDICATOR_POSITION")};var tn=function(e){return e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")};var nn=function(e){return e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION")};var an={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:rn},processProgressIndicator:{opacity:0,align:tn},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}};var on={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:Kt},status:{translateX:Kt}};var un={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}};var sn={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:Kt},status:{translateX:Kt,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:Kt},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:nn},info:{translateX:Kt},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:nn},buttonRemoveItem:{opacity:1},info:{translateX:Kt},status:{opacity:1,translateX:Kt}},DID_LOAD_ITEM:on,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:Kt},status:{translateX:Kt}},DID_START_ITEM_PROCESSING:un,DID_REQUEST_ITEM_PROCESSING:un,DID_UPDATE_ITEM_PROCESS_PROGRESS:un,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:Kt}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:Kt},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:on};var ln=Y({create:function(e){var r=e.root;r.element.innerHTML=r.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:true,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}});var cn=function(e){var r=e.root,t=e.props;var n=Object.keys(Qt).reduce((function(e,r){e[r]=Object.assign({},Qt[r]);return e}),{});var i=t.id;var o=r.query("GET_ALLOW_REVERT");var u=r.query("GET_ALLOW_REMOVE");var s=r.query("GET_ALLOW_PROCESS");var l=r.query("GET_INSTANT_UPLOAD");var c=r.query("IS_ASYNC");var f=r.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");var v;c?s&&!o?v=function(e){return!/RevertItemProcessing/.test(e)}:!s&&o?v=function(e){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(e)}:s||o||(v=function(e){return!/Process/.test(e)}):v=function(e){return!/Process/.test(e)};var d=v?Zt.filter(v):Zt.concat();if(l&&o){n.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM";n.RevertItemProcessing.icon="GET_ICON_REMOVE"}if(c&&!o){var p=sn.DID_COMPLETE_ITEM_PROCESSING;p.info.translateX=en;p.info.translateY=Jt;p.status.translateY=Jt;p.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(c&&!s){["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach((function(e){sn[e].status.translateY=Jt}));sn.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=$t}if(f&&o){n.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";var E=sn.DID_COMPLETE_ITEM_PROCESSING;E.info.translateX=Kt;E.status.translateY=Jt;E.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}u||(n.RemoveItem.disabled=true);a(n,(function(e,t){var n=r.createChildView(Ct,{label:r.query(t.label),icon:r.query(t.icon),opacity:0});d.includes(e)&&r.appendChildView(n);if(t.disabled){n.element.setAttribute("disabled","disabled");n.element.setAttribute("hidden","hidden")}n.element.dataset.align=r.query("GET_STYLE_"+t.align);n.element.classList.add(t.className);n.on("click",(function(e){e.stopPropagation();t.disabled||r.dispatch(t.action,{query:i})}));r.ref["button"+e]=n}));r.ref.processingCompleteIndicator=r.appendChildView(r.createChildView(ln));r.ref.processingCompleteIndicator.element.dataset.align=r.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION");r.ref.info=r.appendChildView(r.createChildView(Ft,{id:i}));r.ref.status=r.appendChildView(r.createChildView(zt,{id:i}));var _=r.appendChildView(r.createChildView(bt,{opacity:0,align:r.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));_.element.classList.add("filepond--load-indicator");r.ref.loadProgressIndicator=_;var T=r.appendChildView(r.createChildView(bt,{opacity:0,align:r.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));T.element.classList.add("filepond--process-indicator");r.ref.processProgressIndicator=T;r.ref.activeStyles=[]};var fn=function(e){var r=e.root,t=e.actions,n=e.props;vn({root:r,actions:t,props:n});var i=t.concat().filter((function(e){return/^DID_/.test(e.type)})).reverse().find((function(e){return sn[e.type]}));if(i){r.ref.activeStyles=[];var o=sn[i.type];a(an,(function(e,t){var n=r.ref[e];a(t,(function(t,i){var a=o[e]&&typeof o[e][t]!=="undefined"?o[e][t]:i;r.ref.activeStyles.push({control:n,key:t,value:a})}))}))}r.ref.activeStyles.forEach((function(e){var t=e.control,n=e.key,i=e.value;t[n]=typeof i==="function"?i(r):i}))};var vn=j({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function(e){var r=e.root,t=e.action;r.ref.buttonAbortItemProcessing.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function(e){var r=e.root,t=e.action;r.ref.buttonAbortItemLoad.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function(e){var r=e.root,t=e.action;r.ref.buttonAbortItemRemoval.label=t.value},DID_REQUEST_ITEM_PROCESSING:function(e){var r=e.root;r.ref.processProgressIndicator.spin=true;r.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:function(e){var r=e.root;r.ref.loadProgressIndicator.spin=true;r.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:function(e){var r=e.root;r.ref.processProgressIndicator.spin=true;r.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:function(e){var r=e.root,t=e.action;r.ref.loadProgressIndicator.spin=false;r.ref.loadProgressIndicator.progress=t.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var r=e.root,t=e.action;r.ref.processProgressIndicator.spin=false;r.ref.processProgressIndicator.progress=t.progress}});var dn=Y({create:cn,write:fn,didCreateView:function(e){$e("CREATE_VIEW",Object.assign({},e,{view:e}))},name:"file"});var pn=function(e){var r=e.root,t=e.props;r.ref.fileName=Rt("legend");r.appendChild(r.ref.fileName);r.ref.file=r.appendChildView(r.createChildView(dn,{id:t.id}));r.ref.data=false};var En=function(e){var r=e.root,t=e.props;Ot(r.ref.fileName,gt(r.query("GET_ITEM_NAME",t.id)))};var _n=Y({create:pn,ignoreRect:true,write:j({DID_LOAD_ITEM:En}),didCreateView:function(e){$e("CREATE_VIEW",Object.assign({},e,{view:e}))},tag:"fieldset",name:"file-wrapper"});var Tn={type:"spring",damping:.6,mass:7};var In=function(e){var r=e.root,t=e.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:Tn},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:Tn},styles:["translateY"]}}].forEach((function(e){mn(r,e,t.name)}));r.element.classList.add("filepond--"+t.name);r.ref.scalable=null};var mn=function(e,r,t){var n=Y({name:"panel-"+r.name+" filepond--"+t,mixins:r.mixins,ignoreRectUpdate:true});var i=e.createChildView(n,r.props);e.ref[r.name]=e.appendChildView(i)};var hn=function(e){var r=e.root,t=e.props;if(r.ref.scalable===null||t.scalable!==r.ref.scalable){r.ref.scalable=!$(t.scalable)||t.scalable;r.element.dataset.scalable=r.ref.scalable}if(t.height){var n=r.ref.top.rect.element;var i=r.ref.bottom.rect.element;var a=Math.max(n.height+i.height,t.height);r.ref.center.translateY=n.height;r.ref.center.scaleY=(a-n.height-i.height)/100;r.ref.bottom.translateY=a-i.height}};var gn=Y({name:"panel",read:function(e){var r=e.root,t=e.props;return t.heightCurrent=r.ref.bottom.translateY},write:hn,create:In,ignoreRect:true,mixins:{apis:["height","heightCurrent","scalable"]}});var Rn=function(e){var r=e.map((function(e){return e.id}));var t=void 0;return{setIndex:function(e){t=e},getIndex:function(){return t},getItemIndex:function(e){return r.indexOf(e.id)}}};var On={type:"spring",stiffness:.75,damping:.45,mass:10};var yn="spring";var Dn={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"};var Sn=function(e){var r=e.root,t=e.props;r.ref.handleClick=function(e){return r.dispatch("DID_ACTIVATE_ITEM",{id:t.id})};r.element.id="filepond--item-"+t.id;r.element.addEventListener("click",r.ref.handleClick);r.ref.container=r.appendChildView(r.createChildView(_n,{id:t.id}));r.ref.panel=r.appendChildView(r.createChildView(gn,{name:"item-panel"}));r.ref.panel.height=null;t.markedForRemoval=false;if(r.query("GET_ALLOW_REORDER")){r.element.dataset.dragState="idle";var n=function(e){if(e.isPrimary){var n=false;var i={x:e.pageX,y:e.pageY};t.dragOrigin={x:r.translateX,y:r.translateY};t.dragCenter={x:e.offsetX,y:e.offsetY};var a=Rn(r.query("GET_ACTIVE_ITEMS"));r.dispatch("DID_GRAB_ITEM",{id:t.id,dragState:a});var o=function(e){if(e.isPrimary){e.stopPropagation();e.preventDefault();t.dragOffset={x:e.pageX-i.x,y:e.pageY-i.y};var o=t.dragOffset.x*t.dragOffset.x+t.dragOffset.y*t.dragOffset.y;if(o>16&&!n){n=true;r.element.removeEventListener("click",r.ref.handleClick)}r.dispatch("DID_DRAG_ITEM",{id:t.id,dragState:a})}};var u=function(e){if(e.isPrimary){t.dragOffset={x:e.pageX-i.x,y:e.pageY-i.y};l()}};var s=function(){l()};var l=function(){document.removeEventListener("pointercancel",s);document.removeEventListener("pointermove",o);document.removeEventListener("pointerup",u);r.dispatch("DID_DROP_ITEM",{id:t.id,dragState:a});n&&setTimeout((function(){return r.element.addEventListener("click",r.ref.handleClick)}),0)};document.addEventListener("pointercancel",s);document.addEventListener("pointermove",o);document.addEventListener("pointerup",u)}};r.element.addEventListener("pointerdown",n)}};var An=j({DID_UPDATE_PANEL_HEIGHT:function(e){var r=e.root,t=e.action;r.height=t.height}});var Ln=j({DID_GRAB_ITEM:function(e){var r=e.root,t=e.props;t.dragOrigin={x:r.translateX,y:r.translateY}},DID_DRAG_ITEM:function(e){var r=e.root;r.element.dataset.dragState="drag"},DID_DROP_ITEM:function(e){var r=e.root,t=e.props;t.dragOffset=null;t.dragOrigin=null;r.element.dataset.dragState="drop"}},(function(e){var r=e.root,t=e.actions,n=e.props,i=e.shouldOptimize;r.element.dataset.dragState==="drop"&&r.scaleX<=1&&(r.element.dataset.dragState="idle");var a=t.concat().filter((function(e){return/^DID_/.test(e.type)})).reverse().find((function(e){return Dn[e.type]}));if(a&&a.type!==n.currentState){n.currentState=a.type;r.element.dataset.filepondItemState=Dn[n.currentState]||""}var o=r.query("GET_ITEM_PANEL_ASPECT_RATIO")||r.query("GET_PANEL_ASPECT_RATIO");if(o)i||(r.height=r.rect.element.width*o);else{An({root:r,actions:t,props:n});!r.height&&r.ref.container.rect.element.height>0&&(r.height=r.ref.container.rect.element.height)}i&&(r.ref.panel.height=null);r.ref.panel.height=r.height}));var bn=Y({create:Sn,write:Ln,destroy:function(e){var r=e.root,t=e.props;r.element.removeEventListener("click",r.ref.handleClick);r.dispatch("RELEASE_ITEM",{query:t.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:yn,scaleY:yn,translateX:On,translateY:On,opacity:{type:"tween",duration:150}}}});var Pn=function(e,r){return Math.max(1,Math.floor((e+1)/r))};var Mn=function(e,r,t){if(t){var n=e.rect.element.width;var i=r.length;var a=null;if(i===0||t.top<r[0].rect.element.top)return-1;var o=r[0];var u=o.rect.element;var s=u.marginLeft+u.marginRight;var l=u.width+s;var c=Pn(n,l);if(c===1){for(var f=0;f<i;f++){var v=r[f];var d=v.rect.outer.top+v.rect.element.height*.5;if(t.top<d)return f}return i}var p=u.marginTop+u.marginBottom;var E=u.height+p;for(var _=0;_<i;_++){var T=_%c;var I=Math.floor(_/c);var m=T*l;var h=I*E;var g=h-u.marginTop;var R=m+l;var O=h+E+u.marginBottom;if(t.top<O&&t.top>g){if(t.left<R)return _;a=_!==i-1?_:null}}return a!==null?a:i}};var Cn={height:0,width:0,get getHeight(){return(this||e).height},set setHeight(r){(this||e).height!==0&&r!==0||((this||e).height=r)},get getWidth(){return(this||e).width},set setWidth(r){(this||e).width!==0&&r!==0||((this||e).width=r)},setDimensions:function(r,t){(this||e).height!==0&&r!==0||((this||e).height=r);(this||e).width!==0&&t!==0||((this||e).width=t)}};var Nn=function(e){var r=e.root;u(r.element,"role","list");r.ref.lastItemSpanwDate=Date.now()};
/**
   * Inserts a new item
   * @param root
   * @param action
   */var wn=function(e){var r=e.root,t=e.action;var n=t.id,i=t.index,a=t.interactionMethod;r.ref.addIndex=i;var o=Date.now();var u=o;var s=1;if(a!==Ae.NONE){s=0;var l=r.query("GET_ITEM_INSERT_INTERVAL");var c=o-r.ref.lastItemSpanwDate;u=c<l?o+(l-c):o}r.ref.lastItemSpanwDate=u;r.appendChildView(r.createChildView(bn,{spawnDate:u,id:n,opacity:s,interactionMethod:a}),i)};var Gn=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1;if(e.dragOffset){e.translateX=null;e.translateY=null;e.translateX=e.dragOrigin.x+e.dragOffset.x;e.translateY=e.dragOrigin.y+e.dragOffset.y;e.scaleX=1.025;e.scaleY=1.025}else{e.translateX=r;e.translateY=t;if(Date.now()>e.spawnDate){e.opacity===0&&Un(e,r,t,n,i);e.scaleX=1;e.scaleY=1;e.opacity=1}}};var Un=function(e,r,t,n,i){if(e.interactionMethod===Ae.NONE){e.translateX=null;e.translateX=r;e.translateY=null;e.translateY=t}else if(e.interactionMethod===Ae.DROP){e.translateX=null;e.translateX=r-n*20;e.translateY=null;e.translateY=t-i*10;e.scaleX=.8;e.scaleY=.8}else if(e.interactionMethod===Ae.BROWSE){e.translateY=null;e.translateY=t-30}else if(e.interactionMethod===Ae.API){e.translateX=null;e.translateX=r-30;e.translateY=null}};
/**
   * Removes an existing item
   * @param root
   * @param action
   */var Bn=function(e){var r=e.root,t=e.action;var n=t.id;var i=r.childViews.find((function(e){return e.id===n}));if(i){i.scaleX=.9;i.scaleY=.9;i.opacity=0;i.markedForRemoval=true}};var Fn=function(e){return e.rect.element.height+e.rect.element.marginBottom*.5+e.rect.element.marginTop*.5};var qn=function(e){return e.rect.element.width+e.rect.element.marginLeft*.5+e.rect.element.marginRight*.5};var Vn=function(r){var t=r.root,n=r.action;var i=n.id,a=n.dragState;var o=t.query("GET_ITEM",{id:i});var u=t.childViews.find((function(e){return e.id===i}));var s=t.childViews.length;var l=a.getItemIndex(o);if(u){var c={x:u.dragOrigin.x+u.dragOffset.x+u.dragCenter.x,y:u.dragOrigin.y+u.dragOffset.y+u.dragCenter.y};var f=Fn(u);var v=qn(u);var d=Math.floor(t.rect.outer.width/v);d>s&&(d=s);var p=Math.floor(s/d+1);Cn.setHeight=f*p;Cn.setWidth=v*d;var E={y:Math.floor(c.y/f),x:Math.floor(c.x/v),getGridIndex:function(){return c.y>Cn.getHeight||c.y<0||c.x>Cn.getWidth||c.x<0?l:(this||e).y*d+(this||e).x},getColIndex:function(){var e=t.query("GET_ACTIVE_ITEMS");var r=t.childViews.filter((function(e){return e.rect.element.height}));var n=e.map((function(e){return r.find((function(r){return r.id===e.id}))}));var i=n.findIndex((function(e){return e===u}));var a=Fn(u);var o=n.length;var s=o;var l=0;var f=0;var v=0;for(var d=0;d<o;d++){l=Fn(n[d]);v=f;f=v+l;if(c.y<f){if(i>d){if(c.y<v+a){s=d;break}continue}s=d;break}}return s}};var _=d>1?E.getGridIndex():E.getColIndex();t.dispatch("MOVE_ITEM",{query:u,index:_});var T=a.getIndex();if(T===void 0||T!==_){a.setIndex(_);if(T===void 0)return;t.dispatch("DID_REORDER_ITEMS",{items:t.query("GET_ACTIVE_ITEMS"),origin:l,target:_})}}};var xn=j({DID_ADD_ITEM:wn,DID_REMOVE_ITEM:Bn,DID_DRAG_ITEM:Vn});
/**
   * Write to view
   * @param root
   * @param actions
   * @param props
   */var Yn=function(e){var r=e.root,t=e.props,n=e.actions,i=e.shouldOptimize;xn({root:r,props:t,actions:n});var a=t.dragCoordinates;var o=r.rect.element.width;var u=r.childViews.filter((function(e){return e.rect.element.height}));var s=r.query("GET_ACTIVE_ITEMS").map((function(e){return u.find((function(r){return r.id===e.id}))})).filter((function(e){return e}));var l=a?Mn(r,s,a):null;var c=r.ref.addIndex||null;r.ref.addIndex=null;var f=0;var v=0;var d=0;if(s.length!==0){var p=s[0].rect.element;var E=p.marginTop+p.marginBottom;var _=p.marginLeft+p.marginRight;var T=p.width+_;var I=p.height+E;var m=Pn(o,T);if(m===1){var h=0;var g=0;s.forEach((function(e,r){if(l){var t=r-l;g=t===-2?.25*-E:t===-1?.75*-E:t===0?E*.75:t===1?E*.25:0}if(i){e.translateX=null;e.translateY=null}e.markedForRemoval||Gn(e,0,h+g);var n=e.rect.element.height+E;var a=n*(e.markedForRemoval?e.opacity:1);h+=a}))}else{var R=0;var O=0;s.forEach((function(e,r){r===l&&(f=1);r===c&&(d+=1);e.markedForRemoval&&e.opacity<.5&&(v-=1);var t=r+d+f+v;var n=t%m;var a=Math.floor(t/m);var o=n*T;var u=a*I;var s=Math.sign(o-R);var p=Math.sign(u-O);R=o;O=u;if(!e.markedForRemoval){if(i){e.translateX=null;e.translateY=null}Gn(e,o,u,s,p)}}))}}};
/**
   * Filters actions that are meant specifically for a certain child of the list
   * @param child
   * @param actions
   */var kn=function(e,r){return r.filter((function(r){return!r.data||!r.data.id||e.id===r.data.id}))};var jn=Y({create:Nn,write:Yn,tag:"ul",name:"list",didWriteView:function(e){var r=e.root;r.childViews.filter((function(e){return e.markedForRemoval&&e.opacity===0&&e.resting})).forEach((function(e){e._destroy();r.removeChildView(e)}))},filterFrameActionsForChild:kn,mixins:{apis:["dragCoordinates"]}});var Hn=function(e){var r=e.root,t=e.props;r.ref.list=r.appendChildView(r.createChildView(jn));t.dragCoordinates=null;t.overflowing=false};var Wn=function(e){var r=e.root,t=e.props,n=e.action;r.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(t.dragCoordinates={left:n.position.scopeLeft-r.ref.list.rect.element.left,top:n.position.scopeTop-(r.rect.outer.top+r.rect.element.marginTop+r.rect.element.scrollTop)})};var Xn=function(e){var r=e.props;r.dragCoordinates=null};var zn=j({DID_DRAG:Wn,DID_END_DRAG:Xn});var Qn=function(e){var r=e.root,t=e.props,n=e.actions;zn({root:r,props:t,actions:n});r.ref.list.dragCoordinates=t.dragCoordinates;if(t.overflowing&&!t.overflow){t.overflowing=false;r.element.dataset.state="";r.height=null}if(t.overflow){var i=Math.round(t.overflow);if(i!==r.height){t.overflowing=true;r.element.dataset.state="overflow";r.height=i}}};var Zn=Y({create:Hn,write:Qn,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}});var Kn=function(e,r,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";t?u(e,r,n):e.removeAttribute(r)};var $n=function(e){if(e&&e.value!==""){try{e.value=""}catch(e){}if(e.value){var r=Rt("form");var t=e.parentNode;var n=e.nextSibling;r.appendChild(e);r.reset();n?t.insertBefore(e,n):t.appendChild(e)}}};var Jn=function(e){var r=e.root,t=e.props;r.element.id="filepond--browser-"+t.id;u(r.element,"name",r.query("GET_NAME"));u(r.element,"aria-controls","filepond--assistant-"+t.id);u(r.element,"aria-labelledby","filepond--drop-label-"+t.id);ei({root:r,action:{value:r.query("GET_ACCEPTED_FILE_TYPES")}});ri({root:r,action:{value:r.query("GET_ALLOW_MULTIPLE")}});ti({root:r,action:{value:r.query("GET_ALLOW_DIRECTORIES_ONLY")}});ni({root:r});ii({root:r,action:{value:r.query("GET_REQUIRED")}});ai({root:r,action:{value:r.query("GET_CAPTURE_METHOD")}});r.ref.handleChange=function(e){if(r.element.value){var n=Array.from(r.element.files).map((function(e){e._relativePath=e.webkitRelativePath;return e}));setTimeout((function(){t.onload(n);$n(r.element)}),250)}};r.element.addEventListener("change",r.ref.handleChange)};var ei=function(e){var r=e.root,t=e.action;r.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&Kn(r.element,"accept",!!t.value,t.value?t.value.join(","):"")};var ri=function(e){var r=e.root,t=e.action;Kn(r.element,"multiple",t.value)};var ti=function(e){var r=e.root,t=e.action;Kn(r.element,"webkitdirectory",t.value)};var ni=function(e){var r=e.root;var t=r.query("GET_DISABLED");var n=r.query("GET_ALLOW_BROWSE");var i=t||!n;Kn(r.element,"disabled",i)};var ii=function(e){var r=e.root,t=e.action;t.value?r.query("GET_TOTAL_ITEMS")===0&&Kn(r.element,"required",true):Kn(r.element,"required",false)};var ai=function(e){var r=e.root,t=e.action;Kn(r.element,"capture",!!t.value,t.value===true?"":t.value)};var oi=function(e){var r=e.root;var t=r.element;if(r.query("GET_TOTAL_ITEMS")>0){Kn(t,"required",false);Kn(t,"name",false);var n=r.query("GET_ACTIVE_ITEMS");var i=false;for(var a=0;a<n.length;a++)n[a].status===je.LOAD_ERROR&&(i=true);r.element.setCustomValidity(i?r.query("GET_LABEL_INVALID_FIELD"):"")}else{Kn(t,"name",true,r.query("GET_NAME"));var o=r.query("GET_CHECK_VALIDITY");o&&t.setCustomValidity("");r.query("GET_REQUIRED")&&Kn(t,"required",true)}};var ui=function(e){var r=e.root;var t=r.query("GET_CHECK_VALIDITY");t&&r.element.setCustomValidity(r.query("GET_LABEL_INVALID_FIELD"))};var si=Y({tag:"input",name:"browser",ignoreRect:true,ignoreRectUpdate:true,attributes:{type:"file"},create:Jn,destroy:function(e){var r=e.root;r.element.removeEventListener("change",r.ref.handleChange)},write:j({DID_LOAD_ITEM:oi,DID_REMOVE_ITEM:oi,DID_THROW_ITEM_INVALID:ui,DID_SET_DISABLED:ni,DID_SET_ALLOW_BROWSE:ni,DID_SET_ALLOW_DIRECTORIES_ONLY:ti,DID_SET_ALLOW_MULTIPLE:ri,DID_SET_ACCEPTED_FILE_TYPES:ei,DID_SET_CAPTURE_METHOD:ai,DID_SET_REQUIRED:ii})});var li={ENTER:13,SPACE:32};var ci=function(e){var r=e.root,t=e.props;var n=Rt("label");u(n,"for","filepond--browser-"+t.id);u(n,"id","filepond--drop-label-"+t.id);r.ref.handleKeyDown=function(e){var t=e.keyCode===li.ENTER||e.keyCode===li.SPACE;if(t){e.preventDefault();r.ref.label.click()}};r.ref.handleClick=function(e){var t=e.target===n||n.contains(e.target);t||r.ref.label.click()};n.addEventListener("keydown",r.ref.handleKeyDown);r.element.addEventListener("click",r.ref.handleClick);fi(n,t.caption);r.appendChild(n);r.ref.label=n};var fi=function(e,r){e.innerHTML=r;var t=e.querySelector(".filepond--label-action");t&&u(t,"tabindex","0");return r};var vi=Y({name:"drop-label",ignoreRect:true,create:ci,destroy:function(e){var r=e.root;r.ref.label.addEventListener("keydown",r.ref.handleKeyDown);r.element.removeEventListener("click",r.ref.handleClick)},write:j({DID_SET_LABEL_IDLE:function(e){var r=e.root,t=e.action;fi(r.ref.label,t.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}});var di=Y({name:"drip-blob",ignoreRect:true,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}});var pi=function(e){var r=e.root;var t=r.rect.element.width*.5;var n=r.rect.element.height*.5;r.ref.blob=r.appendChildView(r.createChildView(di,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:t,translateY:n}))};var Ei=function(e){var r=e.root,t=e.action;if(r.ref.blob){r.ref.blob.translateX=t.position.scopeLeft;r.ref.blob.translateY=t.position.scopeTop;r.ref.blob.scaleX=1;r.ref.blob.scaleY=1;r.ref.blob.opacity=1}else pi({root:r})};var _i=function(e){var r=e.root;r.ref.blob&&(r.ref.blob.opacity=0)};var Ti=function(e){var r=e.root;if(r.ref.blob){r.ref.blob.scaleX=2.5;r.ref.blob.scaleY=2.5;r.ref.blob.opacity=0}};var Ii=function(e){var r=e.root,t=e.props,n=e.actions;mi({root:r,props:t,actions:n});var i=r.ref.blob;if(n.length===0&&i&&i.opacity===0){r.removeChildView(i);r.ref.blob=null}};var mi=j({DID_DRAG:Ei,DID_DROP:Ti,DID_END_DRAG:_i});var hi=Y({ignoreRect:true,ignoreRectUpdate:true,name:"drip",write:Ii});var gi=function(e,r){try{var t=new DataTransfer;r.forEach((function(e){e instanceof File?t.items.add(e):t.items.add(new File([e],e.name,{type:e.type}))}));e.files=t.files}catch(e){return false}return true};var Ri=function(e){var r=e.root;r.ref.fields={};var t=document.createElement("legend");t.textContent="Files";r.element.appendChild(t)};var Oi=function(e,r){return e.ref.fields[r]};var yi=function(e){e.query("GET_ACTIVE_ITEMS").forEach((function(r){e.ref.fields[r.id]&&e.element.appendChild(e.ref.fields[r.id])}))};var Di=function(e){var r=e.root;return yi(r)};var Si=function(e){var r=e.root,t=e.action;var n=r.query("GET_ITEM",t.id);var i=n.origin===He.LOCAL;var a=!i&&r.query("SHOULD_UPDATE_FILE_INPUT");var o=Rt("input");o.type=a?"file":"hidden";o.name=r.query("GET_NAME");r.ref.fields[t.id]=o;yi(r)};var Ai=function(e){var r=e.root,t=e.action;var n=Oi(r,t.id);if(n){t.serverFileReference!==null&&(n.value=t.serverFileReference);if(r.query("SHOULD_UPDATE_FILE_INPUT")){var i=r.query("GET_ITEM",t.id);gi(n,[i.file])}}};var Li=function(e){var r=e.root,t=e.action;r.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout((function(){var e=Oi(r,t.id);e&&gi(e,[t.file])}),0)};var bi=function(e){var r=e.root;r.element.disabled=r.query("GET_DISABLED")};var Pi=function(e){var r=e.root,t=e.action;var n=Oi(r,t.id);if(n){n.parentNode&&n.parentNode.removeChild(n);delete r.ref.fields[t.id]}};var Mi=function(e){var r=e.root,t=e.action;var n=Oi(r,t.id);if(n){t.value===null?n.removeAttribute("value"):n.type!="file"&&(n.value=t.value);yi(r)}};var Ci=j({DID_SET_DISABLED:bi,DID_ADD_ITEM:Si,DID_LOAD_ITEM:Ai,DID_REMOVE_ITEM:Pi,DID_DEFINE_VALUE:Mi,DID_PREPARE_OUTPUT:Li,DID_REORDER_ITEMS:Di,DID_SORT_ITEMS:Di});var Ni=Y({tag:"fieldset",name:"data",create:Ri,write:Ci,ignoreRect:true});var wi=function(e){return"getRootNode"in e?e.getRootNode():document};var Gi=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"];var Ui=["css","csv","html","txt"];var Bi={zip:"zip|compressed",epub:"application/epub+zip"};var Fi=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";e=e.toLowerCase();return Gi.includes(e)?"image/"+(e==="jpg"?"jpeg":e==="svg"?"svg+xml":e):Ui.includes(e)?"text/"+e:Bi[e]||""};var qi=function(e){return new Promise((function(r,t){var n=Qi(e);if(n.length&&!Vi(e))return r(n);xi(e).then(r)}))};var Vi=function(e){return!!e.files&&e.files.length>0};var xi=function(e){return new Promise((function(r,t){var n=(e.items?Array.from(e.items):[]).filter((function(e){return Yi(e)})).map((function(e){return ki(e)}));n.length?Promise.all(n).then((function(e){var t=[];e.forEach((function(e){t.push.apply(t,e)}));r(t.filter((function(e){return e})).map((function(e){e._relativePath||(e._relativePath=e.webkitRelativePath);return e})))})).catch(console.error):r(e.files?Array.from(e.files):[])}))};var Yi=function(e){if(Xi(e)){var r=zi(e);if(r)return r.isFile||r.isDirectory}return e.kind==="file"};var ki=function(e){return new Promise((function(r,t){Wi(e)?ji(zi(e)).then(r).catch(t):r([e.getAsFile()])}))};var ji=function(e){return new Promise((function(r,t){var n=[];var i=0;var a=0;var o=function(){a===0&&i===0&&r(n)};var u=function e(r){i++;var u=r.createReader();var s=function r(){u.readEntries((function(t){if(t.length!==0){t.forEach((function(r){if(r.isDirectory)e(r);else{a++;r.file((function(e){var t=Hi(e);r.fullPath&&(t._relativePath=r.fullPath);n.push(t);a--;o()}))}}));r()}else{i--;o()}}),t)};s()};u(e)}))};var Hi=function(e){if(e.type.length)return e;var r=e.lastModifiedDate;var t=e.name;var n=Fi(yr(e.name));if(!n.length)return e;e=e.slice(0,e.size,n);e.name=t;e.lastModifiedDate=r;return e};var Wi=function(e){return Xi(e)&&(zi(e)||{}).isDirectory};var Xi=function(e){return"webkitGetAsEntry"in e};var zi=function(e){return e.webkitGetAsEntry()};var Qi=function(e){var r=[];try{r=Ki(e);if(r.length)return r;r=Zi(e)}catch(e){}return r};var Zi=function(e){var r=e.getData("url");return typeof r==="string"&&r.length?[r]:[]};var Ki=function(e){var r=e.getData("text/html");if(typeof r==="string"&&r.length){var t=r.match(/src\s*=\s*"(.+?)"/);if(t)return[t[1]]}return[]};var $i=[];var Ji=function(e){return{pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}};var ea=function(e,r,t){var n=ra(r);var i={element:e,filterElement:t,state:null,ondrop:function(){},onenter:function(){},ondrag:function(){},onexit:function(){},onload:function(){},allowdrop:function(){}};i.destroy=n.addListener(i);return i};var ra=function(e){var r=$i.find((function(r){return r.element===e}));if(r)return r;var t=ta(e);$i.push(t);return t};var ta=function(e){var r=[];var t={dragenter:ua,dragover:sa,dragleave:ca,drop:la};var n={};a(t,(function(t,i){n[t]=i(e,r);e.addEventListener(t,n[t],false)}));var i={element:e,addListener:function(o){r.push(o);return function(){r.splice(r.indexOf(o),1);if(r.length===0){$i.splice($i.indexOf(i),1);a(t,(function(r){e.removeEventListener(r,n[r],false)}))}}}};return i};var na=function(e,r){"elementFromPoint"in e||(e=document);return e.elementFromPoint(r.x,r.y)};var ia=function(e,r){var t=wi(r);var n=na(t,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return n===r||r.contains(n)};var aa=null;var oa=function(e,r){try{e.dropEffect=r}catch(e){}};var ua=function(e,r){return function(e){e.preventDefault();aa=e.target;r.forEach((function(r){var t=r.element,n=r.onenter;if(ia(e,t)){r.state="enter";n(Ji(e))}}))}};var sa=function(e,r){return function(e){e.preventDefault();var t=e.dataTransfer;qi(t).then((function(n){var i=false;r.some((function(r){var a=r.filterElement,o=r.element,u=r.onenter,s=r.onexit,l=r.ondrag,c=r.allowdrop;oa(t,"copy");var f=c(n);if(f)if(ia(e,o)){i=true;if(r.state===null){r.state="enter";u(Ji(e));return}r.state="over";if(a&&!f){oa(t,"none");return}l(Ji(e))}else{a&&!i&&oa(t,"none");if(r.state){r.state=null;s(Ji(e))}}else oa(t,"none")}))}))}};var la=function(e,r){return function(e){e.preventDefault();var t=e.dataTransfer;qi(t).then((function(t){r.forEach((function(r){var n=r.filterElement,i=r.element,a=r.ondrop,o=r.onexit,u=r.allowdrop;r.state=null;if(!n||ia(e,i)){if(!u(t))return o(Ji(e));a(Ji(e),t)}}))}))}};var ca=function(e,r){return function(e){aa===e.target&&r.forEach((function(r){var t=r.onexit;r.state=null;t(Ji(e))}))}};var fa=function(e,r,t){e.classList.add("filepond--hopper");var n=t.catchesDropsOnPage,i=t.requiresDropOnElement,a=t.filterItems,o=a===void 0?function(e){return e}:a;var u=ea(e,n?document.documentElement:e,i);var s="";var l="";u.allowdrop=function(e){return r(o(e))};u.ondrop=function(e,t){var n=o(t);if(r(n)){l="drag-drop";c.onload(n,e)}else c.ondragend(e)};u.ondrag=function(e){c.ondrag(e)};u.onenter=function(e){l="drag-over";c.ondragstart(e)};u.onexit=function(e){l="drag-exit";c.ondragend(e)};var c={updateHopperState:function(){if(s!==l){e.dataset.hopperState=l;s=l}},onload:function(){},ondragstart:function(){},ondrag:function(){},ondragend:function(){},destroy:function(){u.destroy()}};return c};var va=false;var da=[];var pa=function(e){var r=document.activeElement;var t=r&&(/textarea|input/i.test(r.nodeName)||r.getAttribute("contenteditable")==="true"||r.getAttribute("contenteditable")==="");if(t){var n=false;var i=r;while(i!==document.body){if(i.classList.contains("filepond--root")){n=true;break}i=i.parentNode}if(!n)return}qi(e.clipboardData).then((function(e){e.length&&da.forEach((function(r){return r(e)}))}))};var Ea=function(e){if(!da.includes(e)){da.push(e);if(!va){va=true;document.addEventListener("paste",pa)}}};var _a=function(e){Be(da,da.indexOf(e));if(da.length===0){document.removeEventListener("paste",pa);va=false}};var Ta=function(){var e=function(e){r.onload(e)};var r={destroy:function(){_a(e)},onload:function(){}};Ea(e);return r};var Ia=function(e){var r=e.root,t=e.props;r.element.id="filepond--assistant-"+t.id;u(r.element,"role","alert");u(r.element,"aria-live","polite");u(r.element,"aria-relevant","additions")};var ma=null;var ha=null;var ga=[];var Ra=function(e,r){e.element.textContent=r};var Oa=function(e){e.element.textContent=""};var ya=function(e,r,t){var n=e.query("GET_TOTAL_ITEMS");Ra(e,t+" "+r+", "+n+" "+(n===1?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL")));clearTimeout(ha);ha=setTimeout((function(){Oa(e)}),1500)};var Da=function(e){return e.element.parentNode.contains(document.activeElement)};var Sa=function(e){var r=e.root,t=e.action;if(Da(r)){r.element.textContent="";var n=r.query("GET_ITEM",t.id);ga.push(n.filename);clearTimeout(ma);ma=setTimeout((function(){ya(r,ga.join(", "),r.query("GET_LABEL_FILE_ADDED"));ga.length=0}),750)}};var Aa=function(e){var r=e.root,t=e.action;if(Da(r)){var n=t.item;ya(r,n.filename,r.query("GET_LABEL_FILE_REMOVED"))}};var La=function(e){var r=e.root,t=e.action;var n=r.query("GET_ITEM",t.id);var i=n.filename;var a=r.query("GET_LABEL_FILE_PROCESSING_COMPLETE");Ra(r,i+" "+a)};var ba=function(e){var r=e.root,t=e.action;var n=r.query("GET_ITEM",t.id);var i=n.filename;var a=r.query("GET_LABEL_FILE_PROCESSING_ABORTED");Ra(r,i+" "+a)};var Pa=function(e){var r=e.root,t=e.action;var n=r.query("GET_ITEM",t.id);var i=n.filename;Ra(r,t.status.main+" "+i+" "+t.status.sub)};var Ma=Y({create:Ia,ignoreRect:true,ignoreRectUpdate:true,write:j({DID_LOAD_ITEM:Sa,DID_REMOVE_ITEM:Aa,DID_COMPLETE_ITEM_PROCESSING:La,DID_ABORT_ITEM_PROCESSING:ba,DID_REVERT_ITEM_PROCESSING:ba,DID_THROW_ITEM_REMOVE_ERROR:Pa,DID_THROW_ITEM_LOAD_ERROR:Pa,DID_THROW_ITEM_INVALID:Pa,DID_THROW_ITEM_PROCESSING_ERROR:Pa}),tag:"span",name:"assistant"});var Ca=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"-";return e.replace(new RegExp(r+".","g"),(function(e){return e.charAt(1).toUpperCase()}))};var Na=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16;var t=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];var n=Date.now();var i=null;return function(){for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];clearTimeout(i);var s=Date.now()-n;var l=function(){n=Date.now();e.apply(void 0,o)};s<r?t||(i=setTimeout(l,r-s)):l()}};var wa=1e6;var Ga=function(e){return e.preventDefault()};var Ua=function(e){var r=e.root,t=e.props;var n=r.query("GET_ID");n&&(r.element.id=n);var i=r.query("GET_CLASS_NAME");i&&i.split(" ").filter((function(e){return e.length})).forEach((function(e){r.element.classList.add(e)}));r.ref.label=r.appendChildView(r.createChildView(vi,Object.assign({},t,{translateY:null,caption:r.query("GET_LABEL_IDLE")})));r.ref.list=r.appendChildView(r.createChildView(Zn,{translateY:null}));r.ref.panel=r.appendChildView(r.createChildView(gn,{name:"panel-root"}));r.ref.assistant=r.appendChildView(r.createChildView(Ma,Object.assign({},t)));r.ref.data=r.appendChildView(r.createChildView(Ni,Object.assign({},t)));r.ref.measure=Rt("div");r.ref.measure.style.height="100%";r.element.appendChild(r.ref.measure);r.ref.bounds=null;r.query("GET_STYLES").filter((function(e){return!z(e.value)})).map((function(e){var t=e.name,n=e.value;r.element.dataset[t]=n}));r.ref.widthPrevious=null;r.ref.widthUpdated=Na((function(){r.ref.updateHistory=[];r.dispatch("DID_RESIZE_ROOT")}),250);r.ref.previousAspectRatio=null;r.ref.updateHistory=[];var a=window.matchMedia("(pointer: fine) and (hover: hover)").matches;var o="PointerEvent"in window;if(r.query("GET_ALLOW_REORDER")&&o&&!a){r.element.addEventListener("touchmove",Ga,{passive:false});r.element.addEventListener("gesturestart",Ga)}var u=r.query("GET_CREDITS");var s=u.length===2;if(s){var l=document.createElement("a");l.className="filepond--credits";l.href=u[0];l.tabIndex=-1;l.target="_blank";l.rel="noopener noreferrer nofollow";l.textContent=u[1];r.element.appendChild(l);r.ref.credits=l}};var Ba=function(e){var r=e.root,t=e.props,n=e.actions;Wa({root:r,props:t,actions:n});n.filter((function(e){return/^DID_SET_STYLE_/.test(e.type)})).filter((function(e){return!z(e.data.value)})).map((function(e){var t=e.type,n=e.data;var i=Ca(t.substring(8).toLowerCase(),"_");r.element.dataset[i]=n.value;r.invalidateLayout()}));if(!r.rect.element.hidden){if(r.rect.element.width!==r.ref.widthPrevious){r.ref.widthPrevious=r.rect.element.width;r.ref.widthUpdated()}var i=r.ref.bounds;if(!i){i=r.ref.bounds=Va(r);r.element.removeChild(r.ref.measure);r.ref.measure=null}var a=r.ref,o=a.hopper,u=a.label,s=a.list,l=a.panel;o&&o.updateHopperState();var c=r.query("GET_PANEL_ASPECT_RATIO");var f=r.query("GET_ALLOW_MULTIPLE");var v=r.query("GET_TOTAL_ITEMS");var d=f?r.query("GET_MAX_FILES")||wa:1;var p=v===d;var E=n.find((function(e){return e.type==="DID_ADD_ITEM"}));if(p&&E){var _=E.data.interactionMethod;u.opacity=0;f?u.translateY=-40:_===Ae.API?u.translateX=40:_===Ae.BROWSE?u.translateY=40:u.translateY=30}else if(!p){u.opacity=1;u.translateX=0;u.translateY=0}var T=Fa(r);var I=qa(r);var m=u.rect.element.height;var h=!f||p?0:m;var g=p?s.rect.element.marginTop:0;var R=v===0?0:s.rect.element.marginBottom;var O=h+g+I.visual+R;var y=h+g+I.bounds+R;s.translateY=Math.max(0,h-s.rect.element.marginTop)-T.top;if(c){var D=r.rect.element.width;var S=D*c;if(c!==r.ref.previousAspectRatio){r.ref.previousAspectRatio=c;r.ref.updateHistory=[]}var A=r.ref.updateHistory;A.push(D);var L=2;if(A.length>L*2){var b=A.length;var P=b-10;var M=0;for(var C=b;C>=P;C--){A[C]===A[C-2]&&M++;if(M>=L)return}}l.scalable=false;l.height=S;var N=S-h-(R-T.bottom)-(p?g:0);I.visual>N?s.overflow=N:s.overflow=null;r.height=S}else if(i.fixedHeight){l.scalable=false;var w=i.fixedHeight-h-(R-T.bottom)-(p?g:0);I.visual>w?s.overflow=w:s.overflow=null}else if(i.cappedHeight){var G=O>=i.cappedHeight;var U=Math.min(i.cappedHeight,O);l.scalable=true;l.height=G?U:U-T.top-T.bottom;var B=U-h-(R-T.bottom)-(p?g:0);O>i.cappedHeight&&I.visual>B?s.overflow=B:s.overflow=null;r.height=Math.min(i.cappedHeight,y-T.top-T.bottom)}else{var F=v>0?T.top+T.bottom:0;l.scalable=true;l.height=Math.max(m,O-F);r.height=Math.max(m,y-F)}r.ref.credits&&l.heightCurrent&&(r.ref.credits.style.transform="translateY("+l.heightCurrent+"px)")}};var Fa=function(e){var r=e.ref.list.childViews[0].childViews[0];return r?{top:r.rect.element.marginTop,bottom:r.rect.element.marginBottom}:{top:0,bottom:0}};var qa=function(e){var r=0;var t=0;var n=e.ref.list;var i=n.childViews[0];var a=i.childViews.filter((function(e){return e.rect.element.height}));var o=e.query("GET_ACTIVE_ITEMS").map((function(e){return a.find((function(r){return r.id===e.id}))})).filter((function(e){return e}));if(o.length===0)return{visual:r,bounds:t};var u=i.rect.element.width;var s=Mn(i,o,n.dragCoordinates);var l=o[0].rect.element;var c=l.marginTop+l.marginBottom;var f=l.marginLeft+l.marginRight;var v=l.width+f;var d=l.height+c;var p=typeof s!=="undefined"&&s>=0?1:0;var E=o.find((function(e){return e.markedForRemoval&&e.opacity<.45}))?-1:0;var _=o.length+p+E;var T=Pn(u,v);if(T===1)o.forEach((function(e){var n=e.rect.element.height+c;t+=n;r+=n*e.opacity}));else{t=Math.ceil(_/T)*d;r=t}return{visual:r,bounds:t}};var Va=function(e){var r=e.ref.measureHeight||null;var t=parseInt(e.style.maxHeight,10)||null;var n=r===0?null:r;return{cappedHeight:t,fixedHeight:n}};var xa=function(e,r){var t=e.query("GET_ALLOW_REPLACE");var n=e.query("GET_ALLOW_MULTIPLE");var i=e.query("GET_TOTAL_ITEMS");var a=e.query("GET_MAX_FILES");var o=r.length;if(!n&&o>1){e.dispatch("DID_THROW_MAX_FILES",{source:r,error:jr("warning",0,"Max files")});return true}a=n?a:1;if(!n&&t)return false;var u=ie(a);if(u&&i+o>a){e.dispatch("DID_THROW_MAX_FILES",{source:r,error:jr("warning",0,"Max files")});return true}return false};var Ya=function(e,r,t){var n=e.childViews[0];return Mn(n,r,{left:t.scopeLeft-n.rect.element.left,top:t.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})};var ka=function(e){var r=e.query("GET_ALLOW_DROP");var t=e.query("GET_DISABLED");var n=r&&!t;if(n&&!e.ref.hopper){var i=fa(e.element,(function(r){var t=e.query("GET_BEFORE_DROP_FILE")||function(){return true};var n=e.query("GET_DROP_VALIDATION");return!n||r.every((function(r){return $e("ALLOW_HOPPER_ITEM",r,{query:e.query}).every((function(e){return e===true}))&&t(r)}))}),{filterItems:function(r){var t=e.query("GET_IGNORED_FILES");return r.filter((function(e){return!at(e)||!t.includes(e.name.toLowerCase())}))},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});i.onload=function(r,t){var n=e.ref.list.childViews[0];var i=n.childViews.filter((function(e){return e.rect.element.height}));var a=e.query("GET_ACTIVE_ITEMS").map((function(e){return i.find((function(r){return r.id===e.id}))})).filter((function(e){return e}));Ke("ADD_ITEMS",r,{dispatch:e.dispatch}).then((function(r){if(xa(e,r))return false;e.dispatch("ADD_ITEMS",{items:r,index:Ya(e.ref.list,a,t),interactionMethod:Ae.DROP})}));e.dispatch("DID_DROP",{position:t});e.dispatch("DID_END_DRAG",{position:t})};i.ondragstart=function(r){e.dispatch("DID_START_DRAG",{position:r})};i.ondrag=Na((function(r){e.dispatch("DID_DRAG",{position:r})}));i.ondragend=function(r){e.dispatch("DID_END_DRAG",{position:r})};e.ref.hopper=i;e.ref.drip=e.appendChildView(e.createChildView(hi))}else if(!n&&e.ref.hopper){e.ref.hopper.destroy();e.ref.hopper=null;e.removeChildView(e.ref.drip)}};var ja=function(e,r){var t=e.query("GET_ALLOW_BROWSE");var n=e.query("GET_DISABLED");var i=t&&!n;if(i&&!e.ref.browser)e.ref.browser=e.appendChildView(e.createChildView(si,Object.assign({},r,{onload:function(r){Ke("ADD_ITEMS",r,{dispatch:e.dispatch}).then((function(r){if(xa(e,r))return false;e.dispatch("ADD_ITEMS",{items:r,index:-1,interactionMethod:Ae.BROWSE})}))}})),0);else if(!i&&e.ref.browser){e.removeChildView(e.ref.browser);e.ref.browser=null}};var Ha=function(e){var r=e.query("GET_ALLOW_PASTE");var t=e.query("GET_DISABLED");var n=r&&!t;if(n&&!e.ref.paster){e.ref.paster=Ta();e.ref.paster.onload=function(r){Ke("ADD_ITEMS",r,{dispatch:e.dispatch}).then((function(r){if(xa(e,r))return false;e.dispatch("ADD_ITEMS",{items:r,index:-1,interactionMethod:Ae.PASTE})}))}}else if(!n&&e.ref.paster){e.ref.paster.destroy();e.ref.paster=null}};var Wa=j({DID_SET_ALLOW_BROWSE:function(e){var r=e.root,t=e.props;ja(r,t)},DID_SET_ALLOW_DROP:function(e){var r=e.root;ka(r)},DID_SET_ALLOW_PASTE:function(e){var r=e.root;Ha(r)},DID_SET_DISABLED:function(e){var r=e.root,t=e.props;ka(r);Ha(r);ja(r,t);var n=r.query("GET_DISABLED");n?r.element.dataset.disabled="disabled":r.element.removeAttribute("data-disabled")}});var Xa=Y({name:"root",read:function(e){var r=e.root;r.ref.measure&&(r.ref.measureHeight=r.ref.measure.offsetHeight)},create:Ua,write:Ba,destroy:function(e){var r=e.root;r.ref.paster&&r.ref.paster.destroy();r.ref.hopper&&r.ref.hopper.destroy();r.element.removeEventListener("touchmove",Ga);r.element.removeEventListener("gesturestart",Ga)},mixins:{styles:["height"]}});var za=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var r=null;var t=rr();var i=n(Re(t),[Tr,Se(t)],[mt,De(t)]);i.dispatch("SET_OPTIONS",{options:e});var a=function(){document.hidden||i.dispatch("KICK")};document.addEventListener("visibilitychange",a);var u=null;var s=false;var l=false;var c=null;var f=null;var v=function(){s||(s=true);clearTimeout(u);u=setTimeout((function(){s=false;c=null;f=null;if(l){l=false;i.dispatch("DID_STOP_RESIZE")}}),500)};window.addEventListener("resize",v);var d=Xa(i,{id:Le()});var p=false;var E=false;var _={_read:function(){if(s){f=window.innerWidth;c||(c=f);if(!l&&f!==c){i.dispatch("DID_START_RESIZE");l=true}}E&&p&&(p=d.element.offsetParent===null);if(!p){d._read();E=d.rect.element.hidden}},_write:function(e){var r=i.processActionQueue().filter((function(e){return!/^SET_/.test(e.type)}));if(!p||r.length){h(r);p=d._write(e,r,l);ke(i.query("GET_ITEMS"));p&&i.processDispatchQueue()}}};var T=function(e){return function(r){var t={type:e};if(!r)return t;r.hasOwnProperty("error")&&(t.error=r.error?Object.assign({},r.error):null);r.status&&(t.status=Object.assign({},r.status));r.file&&(t.output=r.file);if(r.source)t.file=r.source;else if(r.item||r.id){var n=r.item?r.item:i.query("GET_ITEM",r.id);t.file=n?Ye(n):null}r.items&&(t.items=r.items.map(Ye));/progress/.test(e)&&(t.progress=r.progress);if(r.hasOwnProperty("origin")&&r.hasOwnProperty("target")){t.origin=r.origin;t.target=r.target}return t}};var I={DID_DESTROY:T("destroy"),DID_INIT:T("init"),DID_THROW_MAX_FILES:T("warning"),DID_INIT_ITEM:T("initfile"),DID_START_ITEM_LOAD:T("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:T("addfileprogress"),DID_LOAD_ITEM:T("addfile"),DID_THROW_ITEM_INVALID:[T("error"),T("addfile")],DID_THROW_ITEM_LOAD_ERROR:[T("error"),T("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[T("error"),T("removefile")],DID_PREPARE_OUTPUT:T("preparefile"),DID_START_ITEM_PROCESSING:T("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:T("processfileprogress"),DID_ABORT_ITEM_PROCESSING:T("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:T("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:T("processfiles"),DID_REVERT_ITEM_PROCESSING:T("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[T("error"),T("processfile")],DID_REMOVE_ITEM:T("removefile"),DID_UPDATE_ITEMS:T("updatefiles"),DID_ACTIVATE_ITEM:T("activatefile"),DID_REORDER_ITEMS:T("reorderfiles")};var m=function(e){var r=Object.assign({pond:w},e);delete r.type;d.element.dispatchEvent(new CustomEvent("FilePond:"+e.type,{detail:r,bubbles:true,cancelable:true,composed:true}));var t=[];e.hasOwnProperty("error")&&t.push(e.error);e.hasOwnProperty("file")&&t.push(e.file);var n=["type","error","file"];Object.keys(e).filter((function(e){return!n.includes(e)})).forEach((function(r){return t.push(e[r])}));w.fire.apply(w,[e.type].concat(t));var a=i.query("GET_ON"+e.type.toUpperCase());a&&a.apply(void 0,t)};var h=function(e){e.length&&e.filter((function(e){return I[e.type]})).forEach((function(e){var r=I[e.type];(Array.isArray(r)?r:[r]).forEach((function(r){e.type==="DID_INIT_ITEM"?m(r(e.data)):setTimeout((function(){m(r(e.data))}),0)}))}))};var g=function(e){return i.dispatch("SET_OPTIONS",{options:e})};var O=function(e){return i.query("GET_ACTIVE_ITEM",e)};var y=function(e){return new Promise((function(r,t){i.dispatch("REQUEST_ITEM_PREPARE",{query:e,success:function(e){r(e)},failure:function(e){t(e)}})}))};var D=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(t,n){L([{source:e,options:r}],{index:r.index}).then((function(e){return t(e&&e[0])})).catch(n)}))};var S=function(e){return e.file&&e.id};var A=function(e,r){if(typeof e==="object"&&!S(e)&&!r){r=e;e=void 0}i.dispatch("REMOVE_ITEM",Object.assign({},r,{query:e}));return i.query("GET_ACTIVE_ITEM",e)===null};var L=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return new Promise((function(e,t){var n=[];var a={};if(X(r[0])){n.push.apply(n,r[0]);Object.assign(a,r[1]||{})}else{var o=r[r.length-1];typeof o!=="object"||o instanceof Blob||Object.assign(a,r.pop());n.push.apply(n,r)}i.dispatch("ADD_ITEMS",{items:n,index:a.index,interactionMethod:Ae.API,success:e,failure:t})}))};var b=function(){return i.query("GET_ACTIVE_ITEMS")};var P=function(e){return new Promise((function(r,t){i.dispatch("REQUEST_ITEM_PROCESSING",{query:e,success:function(e){r(e)},failure:function(e){t(e)}})}))};var M=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=Array.isArray(r[0])?r[0]:r;var i=n.length?n:b();return Promise.all(i.map(y))};var C=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=Array.isArray(r[0])?r[0]:r;if(!n.length){var i=b().filter((function(e){return!(e.status===je.IDLE&&e.origin===He.LOCAL)&&e.status!==je.PROCESSING&&e.status!==je.PROCESSING_COMPLETE&&e.status!==je.PROCESSING_REVERT_ERROR}));return Promise.all(i.map(P))}return Promise.all(n.map(P))};var N=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=Array.isArray(r[0])?r[0]:r;var i;typeof n[n.length-1]==="object"?i=n.pop():Array.isArray(r[0])&&(i=r[1]);var a=b();if(!n.length)return Promise.all(a.map((function(e){return A(e,i)})));var o=n.map((function(e){return R(e)?a[e]?a[e].id:null:e})).filter((function(e){return e}));return o.map((function(e){return A(e,i)}))};var w=Object.assign({},qe(),{},_,{},ye(i,t),{
/**
       * Override options defined in options object
       * @param options
       */
setOptions:g,
/**
       * Load the given file
       * @param source - the source of the file (either a File, base64 data uri or url)
       * @param options - object, { index: 0 }
       */
addFile:D,
/**
       * Load the given files
       * @param sources - the sources of the files to load
       * @param options - object, { index: 0 }
       */
addFiles:L,
/**
       * Returns the file objects matching the given query
       * @param query { string, number, null }
       */
getFile:O,
/**
       * Upload file with given name
       * @param query { string, number, null  }
       */
processFile:P,
/**
       * Request prepare output for file with given name
       * @param query { string, number, null  }
       */
prepareFile:y,
/**
       * Removes a file by its name
       * @param query { string, number, null  }
       */
removeFile:A,moveFile:function(e,r){return i.dispatch("MOVE_ITEM",{query:e,index:r})},getFiles:b,processFiles:C,removeFiles:N,prepareFiles:M,sort:function(e){return i.dispatch("SORT",{compare:e})},browse:function(){var e=d.element.querySelector("input[type=file]");e&&e.click()},destroy:function(){w.fire("destroy",d.element);i.dispatch("ABORT_ALL");d._destroy();window.removeEventListener("resize",v);document.removeEventListener("visibilitychange",a);i.dispatch("DID_DESTROY")},insertBefore:function(e){return H(d.element,e)},insertAfter:function(e){return W(d.element,e)},appendTo:function(e){return e.appendChild(d.element)},replaceElement:function(e){H(d.element,e);e.parentNode.removeChild(e);r=e},restoreElement:function(){if(r){W(r,d.element);d.element.parentNode.removeChild(d.element);r=null}},
/**
       * Returns true if the app root is attached to given element
       * @param element
       */
isAttachedTo:function(e){return d.element===e||r===e},element:{get:function(){return d.element}},status:{get:function(){return i.query("GET_STATUS")}}});i.dispatch("DID_INIT");return o(w)};var Qa=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var r={};a(rr(),(function(e,t){r[e]=t[0]}));var t=za(Object.assign({},r,{},e));return t};var Za=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};var Ka=function(e){return Ca(e.replace(/^data-/,""))};var $a=function e(r,t){a(t,(function(t,n){a(r,(function(e,i){var a=new RegExp(t);var o=a.test(e);if(o){delete r[e];if(n!==false)if(ee(n))r[n]=i;else{var u=n.group;de(n)&&!r[u]&&(r[u]={});r[u][Za(e.replace(a,""))]=i}}}));n.mapping&&e(r[n.group],n.mapping)}))};var Ja=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t=[];a(e.attributes,(function(r){t.push(e.attributes[r])}));var n=t.filter((function(e){return e.name})).reduce((function(r,t){var n=u(e,t.name);r[Ka(t.name)]=n===t.name||n;return r}),{});$a(n,r);return n};var eo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var t={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":false,"^files$":false};$e("SET_ATTRIBUTE_TO_OPTION_MAP",t);var n=Object.assign({},r);var i=Ja(e.nodeName==="FIELDSET"?e.querySelector("input[type=file]"):e,t);Object.keys(i).forEach((function(e){if(de(i[e])){de(n[e])||(n[e]={});Object.assign(n[e],i[e])}else n[e]=i[e]}));n.files=(r.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map((function(e){return{source:e.value,options:{type:e.dataset.type}}})));var a=Qa(n);e.files&&Array.from(e.files).forEach((function(e){a.addFile(e)}));a.replaceElement(e);return a};var ro=function(){return t(arguments.length<=0?void 0:arguments[0])?eo.apply(void 0,arguments):Qa.apply(void 0,arguments)};var to=["fire","_read","_write"];var no=function(e){var r={};Ve(e,r,to);return r};
/**
   * Replaces placeholders in given string with replacements
   * @param string - "Foo {bar}""
   * @param replacements - { "bar": 10 }
   */var io=function(e,r){return e.replace(/(?:{([a-zA-Z]+)})/g,(function(e,t){return r[t]}))};var ao=function(e){var r=new Blob(["(",e.toString(),")()"],{type:"application/javascript"});var t=URL.createObjectURL(r);var n=new Worker(t);return{transfer:function(e,r){},post:function(e,r,t){var i=Le();n.onmessage=function(e){e.data.id===i&&r(e.data.message)};n.postMessage({id:i,message:e},t)},terminate:function(){n.terminate();URL.revokeObjectURL(t)}}};var oo=function(e){return new Promise((function(r,t){var n=new Image;n.onload=function(){r(n)};n.onerror=function(e){t(e)};n.src=e}))};var uo=function(e,r){var t=e.slice(0,e.size,e.type);t.lastModifiedDate=e.lastModifiedDate;t.name=r;return t};var so=function(e){return uo(e,e.name)};var lo=[];var co=function(e){if(!lo.includes(e)){lo.push(e);var r=e({addFilter:Je,utils:{Type:Qe,forin:a,isString:ee,isFile:at,toNaturalFileSize:Nt,replaceInString:io,getExtensionFromFilename:yr,getFilenameWithoutExtension:nt,guesstimateMimeType:Fi,getFileFromBlob:Lr,getFilenameFromURL:Or,createRoute:j,createWorker:ao,createView:Y,createItemAPI:Ye,loadImage:oo,copyFile:so,renameFile:uo,createBlob:Pr,applyFilterChain:Ke,text:Ot,getNumericAspectRatioFromString:ar},views:{fileActionButton:Ct}});er(r.options)}};var fo=function(){return Object.prototype.toString.call(window.operamini)==="[object OperaMini]"};var vo=function(){return"Promise"in window};var po=function(){return"slice"in Blob.prototype};var Eo=function(){return"URL"in window&&"createObjectURL"in window.URL};var _o=function(){return"visibilityState"in document};var To=function(){return"performance"in window};var Io=function(){return"supports"in(window.CSS||{})};var mo=function(){return/MSIE|Trident/.test(window.navigator.userAgent)};var ho=function(){var e=_()&&!fo()&&_o()&&vo()&&po()&&Eo()&&To()&&(Io()||mo());return function(){return e}}();var go={apps:[]};var Ro="filepond";var Oo=function(){};r.Status={};r.FileStatus={};r.FileOrigin={};r.OptionTypes={};r.create=Oo;r.destroy=Oo;r.parse=Oo;r.find=Oo;r.registerPlugin=Oo;r.getOptions=Oo;r.setOptions=Oo;if(ho()){k((function(){go.apps.forEach((function(e){return e._read()}))}),(function(e){go.apps.forEach((function(r){return r._write(e)}))}));var yo=function e(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:ho,create:r.create,destroy:r.destroy,parse:r.parse,find:r.find,registerPlugin:r.registerPlugin,setOptions:r.setOptions}}));document.removeEventListener("DOMContentLoaded",e)};document.readyState!=="loading"?setTimeout((function(){return yo()}),0):document.addEventListener("DOMContentLoaded",yo);var Do=function(){return a(rr(),(function(e,t){r.OptionTypes[e]=t[1]}))};r.Status=Object.assign({},ur);r.FileOrigin=Object.assign({},He);r.FileStatus=Object.assign({},je);r.OptionTypes={};Do();r.create=function(){var e=ro.apply(void 0,arguments);e.on("destroy",r.destroy);go.apps.push(e);return no(e)};r.destroy=function(e){var r=go.apps.findIndex((function(r){return r.isAttachedTo(e)}));if(r>=0){var t=go.apps.splice(r,1)[0];t.restoreElement();return true}return false};r.parse=function(e){var t=Array.from(e.querySelectorAll("."+Ro));var n=t.filter((function(e){return!go.apps.find((function(r){return r.isAttachedTo(e)}))}));return n.map((function(e){return r.create(e)}))};r.find=function(e){var r=go.apps.find((function(r){return r.isAttachedTo(e)}));return r?no(r):null};r.registerPlugin=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];r.forEach(co);Do()};r.getOptions=function(){var e={};a(rr(),(function(r,t){e[r]=t[0]}));return e};r.setOptions=function(e){if(de(e)){go.apps.forEach((function(r){r.setOptions(e)}));tr(e)}return r.getOptions()}}r.supported=ho;Object.defineProperty(r,"__esModule",{value:true})}));const t=r.Status,n=r.FileStatus,i=r.FileOrigin,a=r.OptionTypes,o=r.create,u=r.destroy,s=r.parse,l=r.find,c=r.registerPlugin,f=r.getOptions,v=r.setOptions,d=r.supported,p=r.__esModule;export{i as FileOrigin,n as FileStatus,a as OptionTypes,t as Status,p as __esModule,o as create,r as default,u as destroy,l as find,f as getOptions,s as parse,c as registerPlugin,v as setOptions,d as supported};

